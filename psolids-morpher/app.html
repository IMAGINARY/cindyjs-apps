<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Platonic morpher</title>
  <link rel="stylesheet" href="../common/css/default.css" media="screen" type="text/css">
  <script type="text/javascript" src="../common/js/quickhull3d/quickhull3d.nocache.js"></script>
  <script type="text/javascript" src="../common/js/Cindy.js"></script>
  <script type="text/javascript" src="../common/js/i18n4js-1.3.0.min.js"></script>
</head>
<body>
<script id="csmouseup" type="text/x-cindyscript">

if(|(wx,wy)|>0.05,
  playanimation(),
  pauseanimation();stopanimation();
);


if(seconds()-presstime<0.2,

xx=mouse().x;
yy=mouse().y;
wy=(startx-xx)*.2;
wx=-(starty-yy)*.2;

mmmx=[
  [1,0,0],
  [0,cos(wx),sin(wx)],
  [0,-sin(wx),cos(wx)]

];


mmmy=[
  [cos(wy),0,-sin(wy)],
  [0,1,0],
  [sin(wy),0,cos(wy)]
];




mat=mmmx*mmmy*mat;
rmat=rmmmx*rmmmy*rmat;


startx=xx;
starty=yy;


pauseanimation();stopanimation();



);









d=1.5;
prevchoice=choice;
if(|mouse().xy,C4|<2,choice=0;iterdepth=0);
if(|mouse().xy,C6|<2,choice=1;iterdepth=0);
if(|mouse().xy,C8|<2,choice=2;iterdepth=0);
if(|mouse().xy,C12|<2,choice=3;iterdepth=0);
if(|mouse().xy,C20|<2,choice=4;iterdepth=0);


if(|mouse().xy-Wand| < 1.2,magic());

if((prevchoice==6)&(choice!=6),
  P.xy=G.xy;
  L.xy=A.xy;
  O.xy=M.xy;
);








</script>
<script id="csdraw" type="text/x-cindyscript">

Dummy.xy=(0,0);
if(O.x<=M.x,O.xy=M.xy);
if(O.x>=N.x,O.xy=N.xy);
if(P.x<=G.x,P.xy=G.xy);
if(P.x>=K.x,P.xy=K.xy);
if(L.x<=A.x,L.xy=A.xy);
if(L.x>=C.x,L.xy=C.xy);

if(W.y<=U.y,W.xy=U.xy);
if(W.y>=V.y,W.xy=V.xy);



//layer(0);
clrscr();
errf(c):=errc(c);
//errf(c):=();
//err("A1 "+seconds());
//err(choice);
//err(tchoice);

if(choice==0,definebody(cell4));
if(choice==1,definebody(cell6));
if(choice==2,definebody(cell8));
if(choice==3,definebody(cell12));
if(choice==4,definebody(cell20));

if(choice==6,definebody(special));

Rot.xy=(Rot-H)/|Rot-H|*2.5+H;
Span.xy=(Span-H)/|Span-H|*2.5+H;
diff=(Rot-H);
diff=diff/|diff|;
rotangle=arctan2(diff);

if(mover()==Rot,
  Span.xy=H+gauss(complex(diff)*exp(i*oldangle))*2.5
);

diff=(Span-H);
diff=diff/|diff|;
spanangle=arctan2(diff);


oldangle=spanangle-rotangle;


colspan=if(spanangle<rotangle,oldangle+2*pi,oldangle);
angle=rotangle;


//angle=0;
//colspan=1.5;
colparams=(colspan,angle);

alpha=|U,W|/|U,V|;


col1=[0,0,1];
col2=[.1,1,0]*0;
col3=[1,0,1]*0;
actcol=(1,1,1);


col1=[.9,.9,1]*.5;
col2=[1,.9,.9]*.5;
col3=[1,1,1]*0;
actcol=(.5,.8,1);


amb=0.2;

lights=[
   [[-cos(30°),-sin(30°),-.5],col1],
   [[-cos(150°),-sin(150°),-.5],col2],
   [[-cos(270°),-sin(270°),-.5],col3]
];
ambient=(1,1,1)*amb;







param1=|G,P|/|G,K|;
param2=|A,L|/|A,C|;
param3=|M,O|/|M,N|;

if(mover()==P & |param1+param3-1|<0.02,param1=1-param3;P.xy=param1*K+(1-param1)*G);
if(mover()==O & |param1+param3-1|<0.02,param3=1-param1;O.xy=param3*N+(1-param3)*M);




paramv=(choice,param1,param2,param3,colspan,angle);

expandfactor=(3,2,1.5,1+tau^2,1+tau^4,0,1.5);
deformface(body,f):=(

  center=sum(f,body_#)/length(f);
  firstdeform=apply(f,(1-param1)*body_#+param1*center);
  firstdeform=firstdeform++[firstdeform_1];
  seconddeform=apply(1..length(f),mid=(firstdeform_#+firstdeform_(#+1))/2;
    [
      (1-param2)*firstdeform_#+param2*mid
,
      (1-param2)*firstdeform_(#+1)+param2*mid
    ]
  );
  seconddeform=flatten(seconddeform,levels->1);
  apply(1..2*length(f),seconddeform_#)++[(1-param3)*center+expandfactor_(choice+1)*param3*center];
);

deform(body,faces):=(
                     flatten(apply(faces,f,
                                   center=sum(f,body_#)/length(f);
                                   fcache=apply(f,(1-param1)*body_#+param1*center);
                                   apply(cycle(fcache),
                                         mid=((#_1)+(#_2))/2;
                                         [(1-param2)*(#_1)+param2*mid,
                                          (1-param2)*(#_2)+param2*mid]
                                         ) :> [(1-param3)*center+expandfactor_(choice+1)*param3*center]
                                   ), levels->2)
                     );

deformX(body,faces):=(

  count=0;
  forall(faces,f,
     center=sum(f,body_#)/length(f);
     nf=0;
     forall(f,nf=nf+1;fcache_nf=(1-param1)*body_#+param1*center;);
     fcache_(nf+1)=fcache_1;
     repeat(nf,
        mid=((fcache_#)+(fcache_(#+1)))/2;
        count=count+1;
        cache_count=(1-param2)*fcache_#+param2*mid;
        count=count+1;
        cache_count=(1-param2)*fcache_(#+1)+param2*mid;
     );
     count=count+1;
     cache_count=(1-param3)*center+expandfactor_(choice+1)*param3*center;
   );
   cache_(1..count);
);



if(|paramv,oldparamv|>0.0001,
errf("A1 "+seconds());
objx=deform(body,faces);
errf("A2 "+seconds());


init=0;
if(length(objx)>3,



 ch=convexhull3d(objx);
errf("A3 "+seconds());

 obj=ch_1*2;


//err(length(obj));

 ff=ch_2;
//if(ff!=ffold,err(ff));
ffold=ff;

 actcol=(.5,.8,1);

 ff=apply(ff,reverse(#));




 faces=apply(ff,[#,colorf(obj,#)]);
// faces=apply(ff,[#,(0,1,1)]);

 oldparamv=paramv;

 );
  object(obj,faces);
);//End recalc
errf("A4 "+seconds());

//err("A3 "+seconds());

gsave();
translate((-1,0));
 render3d();

grestore();

errf("A5 "+seconds());
highlight(a):=(
repeat(10,i,
  fillcircle(a,-i*.1+1.9,alpha->i/10,color->(0.6,0.6,.9)*.6);
 );
);

//err("A4 "+seconds());









//drawpoly(((15,-4),(100,-4),(100,20),(15,20)),color->(0.3,0.4,0.5));

colchoice(i):=if(i==choice,(1,1,1),(1,1,1)*.5);

//drawtext((15,8),"Tetraeder",size->14,color->colchoice(0));
//drawtext((15,6.5),"Würfel",size->14,color->colchoice(1));
//drawtext((15,5),"Oktaeder",size->14,color->colchoice(2));
//drawtext((15,3.5),"Dodekaeder",size->14,color->colchoice(3));
//drawtext((15,2),"Ikosaeder",size->14,color->colchoice(4));





repeat(round(colspan/3°)-1,i,
  draw(
   H+(0,0.05)+|Rot-H|*(cos(i*3°+angle),sin(i*3°+angle)),
   H+(0,0.05)+|Rot-H|*(cos(i*3°+angle-3°),sin(i*3°+angle-3°)),
   color->(1,1,1),size->6);
);




drawtext((14,9.5),international("Start"),color->(1,1,1),size->36);
drawtext((14,-2.5),international("Faces"),color->(1,1,1),size->34);
drawtext((14,-4.5),international("Edges"),color->(1,1,1),size->34);
drawtext((14,-0.5),international("Mid"),color->(1,1,1),size->34);
off=(-.05,0);
w=1.8;

//layer(4);
highlight(but):= connect(
    (
      off+but+(1,1)*w,
      off+but+(-1,1)*w,
      off+but+(-1,-1)*w,
      off+but+(1,-1)*w,
      off+but+(1,1)*w
  ),color->(1,1,1)*.7,size->2
);

dehighlight(but):= fillpoly(
    (
      off+but+(1,1)*w,
      off+but+(-1,1)*w,
      off+but+(-1,-1)*w,
      off+but+(1,-1)*w,
      off+but+(1,1)*w
  ),color->(1,1,1)*.0,size->2,alpha->0.6
);


if(length(objx)>1500,dehighlight(Wand));


if(choice==0,highlight(C4));
if(choice==1,highlight(C6));
if(choice==2,highlight(C8));
if(choice==3,highlight(C12));
if(choice==4,highlight(C20));
if(choice==6,highlight(Wand));


drawtext((-1.5,-12),international("Move"),color->(1,1,1),align->"center",size->26,family->"Arial");




drawimage(Wand,"image1",scale->2.5);
drawimage(C4,"image2",scale->2.5);
drawimage(C6,"image3",scale->2.5);
drawimage(C8,"image4",scale->2.5);
drawimage(C12,"image5",scale->2.5);
drawimage(C20,"image6",scale->2.5);
drawimage(H,"image8",scale->2.7);








</script>
<script id="cstick" type="text/x-cindyscript">

 wx=wx*0.998;
 wy=wy*0.998;

if(|(wx,wy)|<0.001,pauseanimation();stopanimation(););
sp=0.3;
mmmx=[
  [1,0,0],
  [0,cos(wx*sp),sin(wx*sp)],
  [0,-sin(wx*sp),cos(wx*sp)]

];


mmmy=[
  [cos(wy*sp),0,-sin(wy*sp)],
  [0,1,0],
  [sin(wy*sp),0,cos(wy*sp)]
];


mat=mmmx*mmmy*mat;




</script>
<script id="csmousedown" type="text/x-cindyscript">
startx=mouse().x;
starty=mouse().y;
dragging=
|mouse().xy,W|>.3
&|mouse().xy,O|>.3
&|mouse().xy,L|>.3
&|mouse().xy,P|>.3
&|mouse().xy,Rot|>.3&|mouse().xy,Span|>.3
&mouse().x<11;




presstime=seconds();

</script>
<script id="csmousedrag" type="text/x-cindyscript">
if(dragging,

xx=mouse().x;
yy=mouse().y;
wy=(startx-xx)*.2;
wx=-(starty-yy)*.2;

mmmx=[
  [1,0,0],
  [0,cos(wx),sin(wx)],
  [0,-sin(wx),cos(wx)]
];


mmmy=[
  [cos(wy),0,-sin(wy)],
  [0,1,0],
  [sin(wy),0,cos(wy)]
];



  mat=mmmx*mmmy*mat;



startx=xx;
starty=yy;



);



</script>
<script id="csinit" type="text/x-cindyscript">

cache=zerovector(5000);
fcache=zerovector(100);



wx=0;
wy=0;
oldparamv=(0,0,0,0,0,0);
oldcolparams=(0,0);

choice=2;
multicol=1;
next():=(choice=choice+1;if(choice==5,choice=1));
anim=false;

scal=0.15;

init=0;


mat=[
  [1,0,0],
  [0,1,0],
  [0,0,1]
];

mat0=[
  [1,0,0],
  [0,1,0],
  [0,0,1]
];



mmmx=mat0;
mmmy=mat0;





edgecol=(0.76,0.78,0.54);
edgecol=(.9,.9,.9);
edgecol=(0.4,0.3,0.3);

//Das Malt einen Punkt aus homogenen Koordinaten
renderPoint(p):=(
  pp=mat*p;
  draw((pp_1,pp_2),color->edgecol,border->false,size->3)
);

//Das Malt ein Segment aus homogenen Koordinaten
renderLine(p,q):=(
  pp=mat*p;
  qq=mat*q;
  draw((pp_1,pp_2),(qq_1,qq_2));
);




norm(p):=(p_1,p_2,p_3);




renderPolygon(pol,col):=(
//  pp=apply(pol,mat*#);

pp=pol;
  aa=pp_1;bb=pp_2,cc=pp_3;
  nn=cross(bb-aa,bb-cc);
  nn=nn/abs(nn);
  rgb=ambient;

  forall(lights,(
      shade=-sin(nn*#_1);
      if(nn*#_1>0,shade=0);
      rgb=rgb+#_2*shade;
    )
  );
  pp=apply(pp,(#_1,#_2));
  aa=pol_1;bb=pol_2,cc=pol_3;

  fillpoly(pp,color->(rgb_1*col_1,rgb_2*col_2,rgb_3*col_3),alpha->.8);
  connect(pp++[pp_1],color->(1,1,1)*.5,size->.5*3);
//draw(center(pp),(nn_1,nn_2)*1+center(pp),color->(1,1,1));
);

renderPolygonB(pp,col):=(
//  pp=apply(pol,mat*#);

  aa=pp_1;bb=pp_2,cc=pp_3;
  nn=cross(bb-aa,bb-cc);
  nn=nn/abs(nn);
  rgb=ambient;
  forall(lights,(
      shade=-sin(nn*#_1);
      if(nn*#_1>0,shade=0);
      rgb=rgb+#_2*shade;
    )
  );
  pp=apply(pp,(#_1,#_2));

  fillpoly(pp,color->(rgb_1*col_1,rgb_2*col_2,rgb_3*col_3),alpha->alpha);
  connect(pp++[pp_1],color->(1,1,1)*.5,size->.5*(.7)^iterdepth*2);
//draw(center(pp),(nn_1,nn_2)*1+center(pp),color->(1,1,1));
);

renderPolygonF(pp,col):=(
//  pp=apply(pol,mat*#);
  aa=pp_1;bb=pp_2,cc=pp_3;
  nn=cross(bb-aa,bb-cc);
  nn=nn/abs(nn);
  rgb=ambient;

  forall(lights,(
      shade=-sin(nn*#_1);
      if(nn*#_1>0,shade=0);
      rgb=rgb+#_2*shade;
    )
  );
  pp=apply(pp,(#_1,#_2));
  fillpoly(pp,color->(rgb_1*col_1,rgb_2*col_2,rgb_3*col_3),alpha->alpha);
  connect(pp++[pp_1],color->(1,1,1)*sum(col)*.5,size->1*(.7)^iterdepth*2);
//draw(center(pp),(nn_1,nn_2)*1+center(pp),color->(1,1,1));
);




renderPolygonX(pol,col):=(
//  pp=apply(pol,mat*#);

pp=pol;
  pp=apply(pp,(#_1,#_2));
  drawpoly(pp,alpha->1);
);




init3d():=(
// renderlist=[];
// pr=[];
);

center(ll):=sum(ll)/length(ll);


poly3d(l):=(l);



draw3d(a,b):=();


pro(vert):=(vert_1,vert_2,1);

ori(pol):=(
  det(pro(pol_1),pro(pol_2),pro(pol_3))
);

render3d():=(
mati=transpose(mat);

  if(init==0,

  renderlist=
  apply(pr,ll,
    mll=apply(ll_1,mat*(#))/scal;
    [mll,center(mll)_3,ll_2]
  );

  init=1;
  ,
  ii=1;

  forall(pr,ll,
    mll=ll_1*mati/scal;

    (renderlist_ii)_1=mll;
    (renderlist_ii)_2=center(mll)_3;
    (renderlist_ii)_3=ll_2;
      ii=ii+1;
  );



);


//  rl=sort(renderlist,#_2);

  forall(renderlist,pol,
      if(ori(pol_1)~>=0,
       renderPolygonB(pol_1,pol_3*(pol_2+10)/10)
      );
  );


 forall(renderlist,pol,
      if(ori(pol_1)~<=0,
       renderPolygonF(pol_1,pol_3*(pol_2+10)/10)
      );
);


//err("B4 "+seconds());

);




//berechnet innkugel und umkugelradius

minmax(obj):= (
 if(length(obj)>3,
  ch=convexhull3d(obj);
  obj=ch_1;
  maxval=1/(-sort(apply(ch_1,-|#|))_1);
  ff=ch_2;
  dual=apply(ff,f,
    linearsolve((obj_(f_1),obj_(f_2),obj_(f_3)),(1,1,1));
  );
  ch=convexhull3d(dual);
  minval=-sort(apply(ch_1,-|#|))_1;
  (minval,maxval);
  ,
  (|obj_1|,|obj_1|);
 );
);


perm(a,b,c):=(
  (a,b,c),
  (a,c,b),
  (b,a,c),
  (b,c,a),
  (c,a,b),
  (c,b,a)
);


perm1(a,b,c):=(
  (a,b,c),
  (b,c,a),
  (c,a,b)
);




matrz(w):=(
(cos(w),sin(w),0),
(-sin(w),cos(w),0),
(0,0,1)
);

matrx(w):=(
(1,0,0),
(0,cos(w),sin(w)),
(0,-sin(w),cos(w))
);

matry(w):=(
(cos(w),0,-sin(w)),
(0,1,0),
(sin(w),0,cos(w))
);




nn(v):=v/|v|;




iterdepth=0;

definebody(zell):=(
  body=zell_1;
  segs=zell_2;
  faces=zell_3;
if(choice!=6, initdirs=apply(body,#/|#|));
);

spanfactor=(0.24,.38,.38,0.78,0.78,0,0,0,0);
spanfac():=(
  sf=1;
  if(choice<6,sf=spanfactor_(choice+1));
  sfold=of;
  if(choice==6,sf=sfold);
  sf;1
);



colorf(obj,ff):=actcol;
colorf(obj,ff):=(

nn=linearsolve((obj_(ff_1),obj_(ff_2),obj_(ff_3)),(1,1,1));
nn=nn/|nn|;
dd=-sort(apply(initdirs,-#*nn))_1;
hue(colspan*spanfactor_(choice+1)*(dd-1)+(angle+colspan)/(2*pi));
);


colorfx(obj,ff):=(
nn=linearsolve((obj_(ff_1),obj_(ff_2),obj_(ff_3)),(1,1,1));

hue(4*1/|nn|);
);



 object(obj,faces):=(
      pr= apply(faces,fa,[apply(fa_1,obj_#),fa_2])
 );


ambient=(0.2,0.2,0.2);


choice=1;
tchoice=1;



perm3(b,c,d):=(
 (b,c,d),
 (b,d,c),
 (c,b,d),
 (c,d,b),
 (d,b,c),
 (d,c,b)
);


perm3ev(b,c,d):=(
 (b,c,d),
 (c,d,b),
 (d,b,c)
);



pm1(b,c,d):=(
   (b,c,d),
   (-b,c,d));

pm2(b,c,d):=
pm1(b,c,d)++pm1(b,-c,d);
pm3(b,c,d):=
pm2(b,c,d)++pm2(b,c,-d);

tau=(sqrt(5)-1)/2;

s1=0.5;

cell4=s1*[(1,1,1),(1,-1,-1),(-1,1,-1),(-1,-1,1)];
cell8=s1*set(flatten(apply(pm1(1,0,0),perm3(#_1,#_2,#_3)),levels->1));
cell6=s1*set(pm3(1,1,1));
cell12=(s1*set(flatten(apply(pm2(1+tau,tau,0),perm3ev(#_1,#_2,#_3)),levels->1))++cell6)*s1;
cell20=s1*set(flatten(apply(pm2(1,tau,0),perm3ev(#_1,#_2,#_3)),levels->1));




calcsegs(body):=(
  ch=convexhull3d(body);
  pts=ch_1;
  cfaces=ch_2;
  csegs=apply(cfaces,f,ff=f++[f_1];apply(1..length(f),set([ff_#,ff_(#+1)])));
  csegs=set(flatten(csegs,levels->1));
  (pts,csegs,cfaces);
);

definepoly(body):=(
  q=calcsegs(body);
  q
);

cell4=(definepoly(cell4));
cell8=(definepoly(cell8*1.3));
cell6=(definepoly(cell6*0.8));
cell12=(definepoly(cell12*1.5));
cell20=(definepoly(cell20*1.1));


magic():=(
if(length(objx)<1500,

  id=initdirs;
spanfactor_7=spanfactor_(choice+1);
  choice=6;
  P.xy=G.xy;
  L.xy=A.xy;
  O.xy=M.xy;
  special=definepoly(objx);
  initdirs=id;
iterdepth=iterdepth+1;
);
);

javascript("loaded()");


</script>

<script type="text/javascript">
  var data = {
    "background": "rgb(0,0,0)",
    "geometry": [
      {
        "name": "U",
        "type": "Free",
        "pos": [
          4.0,
          -3.2,
          0.26666666666666666
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "pinned":true,
        "visible": false,
        "size": 2.0
      },
      {
        "name": "V",
        "type": "Free",
        "pos": [
          4.0,
          -1.8666666666666667,
          0.26666666666666666
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "pinned":true,
        "visible": false,
        "size": 2.0
      },
      {
        "name": "g",
        "type": "Segment",
        "pos": [
          -0.26666666666666666,
          -0.0,
          4.0
        ],
        "color": [
          0.5019608,
          0.5019608,
          0.5019608
        ],
        "args": [
          "U",
          "V"
        ],
        "size": 3
      },
      {
        "name": "W",
        "type": "PointOnLine",
        "pos": [
          4.0,
          -2.474666666666667,
          0.2666666666666667
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "args": [
          "g"
        ],
        "narrow":true,
        "size": 6.0
      },
      {
        "name": "H",
        "type": "Free",
        "pos": [
          4.0,
          -1.9074446680080486,
          0.2012072434607646
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "pinned": true
      },
      {
        "name": "C1",
        "type": "CircleMr",
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "args": [
          "H"
        ],
        "visible": false,
        "size": 1,
        "printname": "$C_{1}$",
        "radius":4
      },
      {
        "name": "Rot",
        "type": "Free",
        "narrow":true,
        "pos": [
          4.0,
          -1.7819742732112895,
          0.17841102347588844
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "args": [

        ],
        "plane": 3
      },
      {
        "name": "Span",
        "type": "Free",
        "narrow":true,
        "pos": [
          4.0,
          -1.519543949003716,
          0.21298655916459697
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "args": [

        ],
        "plane": 3,
        "size": 3.0
      },
      {
        "name": "A",
        "type": "Free",
        "pos": [
          4.0,
          -1.4285714285714286,
          0.2857142857142857
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "pinned":true,
        "visible": false
      },
      {
        "name": "C",
        "type": "Free",
        "pos": [
          4.0,
          -0.8333333333333334,
          0.16666666666666666
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "pinned":true,
        "visible": false
      },
      {
        "name": "a",
        "type": "Segment",
        "pos": [
          0.0,
          0.8,
          4.0
        ],
        "color": [
          0.5019608,
          0.5019608,
          0.5019608
        ],
        "args": [
          "A",
          "C"
        ],
        "size": 3
      },
      {
        "name": "G",
        "type": "Free",
        "pos": [
          4.0,
          -0.8571428571428571,
          0.2857142857142857
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "pinned":true,
        "visible": false
      },
      {
        "name": "K",
        "type": "Free",
        "pos": [
          4.0,
          -0.5,
          0.16666666666666666
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "pinned":true,
        "visible": false
      },
      {
        "name": "c",
        "type": "Segment",
        "pos": [
          0.0,
          1.3333333333333333,
          4.0
        ],
        "color": [
          0.5019608,
          0.5019608,
          0.5019608
        ],
        "args": [
          "G",
          "K"
        ],
        "size": 3
      },
      {
        "name": "L",
        "type": "PointOnLine",
        "pos": [
          4.0,
          -1.4285714285714277,
          0.2857142857142856
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "args": [
          "a"
        ],
        "narrow":true,
        "size": 6.0
      },
      {
        "name": "M",
        "type": "Free",
        "pos": [
          4.0,
          -0.2857142857142857,
          0.2857142857142857
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "pinned": true,
        "visible": false
      },
      {
        "name": "N",
        "type": "Free",
        "pos": [
          4.0,
          -0.16666666666666666,
          0.16666666666666666
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "pinned": true,
        "visible": false
      },
      {
        "name": "d",
        "type": "Segment",
        "pos": [
          0.0,
          -4.0,
          -4.0
        ],
        "color": [
          0.5019608,
          0.5019608,
          0.5019608
        ],
        "args": [
          "M",
          "N"
        ],
        "size": 3
      },
      {
        "name": "O",
        "type": "PointOnLine",
        "pos": [
          4.0,
          -0.28571428571428575,
          0.28571428571428575
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "args": [
          "d"
        ],
        "narrow":true,
        "size": 6.0
      },
      {
        "name": "P",
        "type": "PointOnLine",
        "pos": [
          4.0,
          -0.7590984016221631,
          0.2530328005407211
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "args": [
          "c"
        ],
        "narrow":true,
        "size": 6.0
      },
      {
        "name": "Wand",
        "type": "Free",
        "pos": [
          4.0,
          0.5217391304347825,
          0.17391304347826086
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "visible":false,
        "pinned": true
      },
      {
        "name": "C4",
        "type": "Free",
        "pos": [
          4.0,
          1.8666666666666667,
          0.26666666666666666
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "visible":false,
        "pinned": true
      },
      {
        "name": "C6",
        "type": "Free",
        "pos": [
          4.0,
          1.4736842105263157,
          0.21052631578947367
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "visible":false,
        "pinned": true
      },
      {
        "name": "C12",
        "type": "Free",
        "pos": [
          4.0,
          0.8,
          0.26666666666666666
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "visible":false,
        "pinned": true
      },
      {
        "name": "C20",
        "type": "Free",
        "pos": [
          4.0,
          0.631578947368421,
          0.21052631578947367
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "visible":false,
        "pinned": true
      },
      {
        "name": "B8",
        "type": "Free",
        "pos": [
          4.0,
          -1.8993963782696177,
          0.2012072434607646
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "pinned": true
      },
      {
        "name": "C8",
        "type": "Free",
        "pos": [
          4.0,
          1.2173913043478262,
          0.17391304347826086
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "visible":false,
        "pinned": true
      },
      {
        "name": "Dummy",
        "type": "Free",
        "pos": [
          0,0,1
        ],
        "color": [
          1.0,
          1.0,
          1.0
        ],
        "visible":false,
        "pinned": false
      }

    ],
    "height": 768,
    "originX": 269.0,
    "originY": 424.0,
    "scale": 30,
    "scripts": {},
    "width": 1024
  };

  var ready = createCindy.waitFor('i18n');
  var translations = {};
  IMAGINARY.i18n.init().then(function(lang){
    translations[lang] = IMAGINARY.i18n.getStrings();
    ready();
  }).catch(function(err){
    console.log("Error loading translation: " + err);
    throw err;
  });

  cdy=createCindy({
    language: IMAGINARY.i18n.getLang(),
    translations: translations,

    ports: [{
      id: "CSCanvas",
      width: 1920,
      height: 1080,
      transform: [{visibleRect: [-10, 10.5, 22, -12.5]}],
      background: "rgb(0,0,0)"
    }],



    scripts: "cs*",
    defaultAppearance: {
    },
    geometry: data.geometry,
    images:{
      image1:"img/image-1.png",
      image2:"img/image-2.png",
      image3:"img/image-3.png",
      image4:"img/image-4.png",
      image5:"img/image-5.png",
      image6:"img/image-6.png",
      image7:"img/image-7.png",
      image8:"img/image-8.png"                }
  });
  var loaded=function(){
    if(window.hasOwnProperty('webkit'))
      window.webkit.messageHandlers.interOp.postMessage({loaded:1});
  }

</script>
<canvas id="CSCanvas"></canvas>
</body>
</html>
