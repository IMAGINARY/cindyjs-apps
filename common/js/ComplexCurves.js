/**
 * @license
 *
 * Complex Curves
 *
 * Copyright 2016-2017 Stefan Kranich
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
(function(){
'use strict';var k,aa={"Assembly.vert":"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nin float index;\nuniform float numIndices;\nuniform sampler2D samplers[1 + N/2];\nuniform float sheet;\nout vec4 posValue;\nvec2 texCoord[3];\n\n#define W 2048.0\n#define H 2048.0\nvec2 uvPosition (in float i) {\n    return vec2 (mod (i, W) / W + 0.5 / W, floor (i / W) / H + 0.5 / H);\n}\n\nvoid readTex (out vec2 pos[3], out float delta[3], out vec2 values[3*N]) {\n    vec4 s;\n    for (int i = 0; i < 3; i++) {\n        s = texture (samplers[0], texCoord[i]);\n        pos[i] = s.xy;\n        delta[i] = s.z;\n        for (int j = 1; j < N/2; j++) {\n            s = texture (samplers[j], texCoord[i]);\n            values[i*N+2*j-2] = s.xy;\n            values[i*N+2*j-1] = s.zw;\n        }\n    }\n}\n\nbool valid (in vec2 position[3], in float delta[3]) {\n    return distance (position[0], position[1]) < min (delta[0], delta[1])\n    && distance (position[1], position[2]) < min (delta[1], delta[2])\n    && distance (position[2], position[0]) < min (delta[2], delta[0]);\n}\n\nvoid main(void) {\n    float which = mod (index, 3.0);\n    texCoord[0] = uvPosition (index - which);\n    texCoord[1] = uvPosition (index - which + 1.0);\n    texCoord[2] = uvPosition (index - which + 2.0);\n\n    int isheet = int(sheet);\n    if (isheet < sheets) {\n        vec2 pos[3];\n        float delta[3];\n        vec2 values[3*N];\n        readTex (pos, delta, values);\n        if (valid (pos, delta)) {\n            for (int s = 0; s < sheets; s++) {\n                if (s == isheet) {\n                    vec2 valueA = values[s];\n                    int iwhich = int(which);\n                    for (int w = 0; w < 3; w++) {\n                        if (w == iwhich) {\n                            vec2 valueWhich = values[w*N];\n                            float dist, minDist = distance (valueA, valueWhich);\n                            for (int i = 1; i < sheets; i++) {\n                                dist = distance (valueA, values[w*N+i]);\n                                if (dist < minDist)\n                                {\n                                    valueWhich = values[w*N+i];\n                                    minDist = dist;\n                                }\n                            }\n                            posValue = vec4(pos[w], valueWhich);\n                        }\n                    }\n                }\n            }\n        return;\n        }\n    }\n    posValue = vec4(-10.0, -10.0, -10.0, 1.0);\n}\n",
"CachedSurface.frag":"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform bool clipping;\nvarying vec4 vPos;\nvarying vec2 vValue;\nvec3 hue_to_rgb (in float hue)\n{\n    hue = mod (degrees (hue), 360.0) / 60.0;\n    int h = int (floor (hue));\n    float f = fract (hue);\n    if (h == 0)\n        return vec3 (1.0, f, 0.0);\n    else if (h == 1)\n        return vec3 (1.0 - f, 1.0, 0.0);\n    else if (h == 2)\n        return vec3 (0.0, 1.0, f);\n    else if (h == 3)\n        return vec3 (0.0, 1.0 - f, 1.0);\n    else if (h == 4)\n        return vec3 (f, 0.0, 1.0);\n    else if (h == 5)\n        return vec3 (1.0, 0.0, 1.0 - f);\n}\nfloat sawfct (float x, float dx, float a, float b)\n{\n    return a + (b - a) * fract (x / dx);\n}\nvoid main (void)\n{\n    if (clipping && vPos.y < 0.0)\n        discard;\n    float PI = acos (-1.0);\n    float angle = atan (vValue.y, vValue.x);\n    float blackp = sawfct (angle, PI / 12.0, 0.7, 1.0);\n    float blackm = sawfct (log (length (vValue)), PI / 12.0, 0.7, 1.0);\n    float black = blackp * blackm;\n    gl_FragColor = vec4 (black * hue_to_rgb (angle), gl_FragCoord.z);\n}\n",
"CachedSurface.vert":"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute vec4 position;\nuniform mat4 m, v, p;\nvarying vec4 vPos;\nvarying vec2 vValue;\nvoid main (void)\n{\n    vPos = vec4 (position.xyz, 1.0);\n    vValue = position.zw;\n    gl_Position = p * v * m * vPos;\n}\n","Common.glsl":"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#define EPS 5e-3\n\n/* complex division */\nvec2 cd (in vec2 a, in vec2 b) {\n\treturn vec2 (a.x * b.x + a.y * b.y, a.y * b.x - a.x * b.y) / dot (b, b);\n}\n\nvec2 cinv (in vec2 z) {\n    return vec2(z.x, -z.y) / dot(z, z);\n}\n\n/* complex square root */\nvec2 csqrt (in vec2 z)\n{\n    float r = sqrt (length (z));\n    float phi = 0.5 * atan (z.y, z.x);\n    return r * vec2 (cos (phi), sin (phi));\n}\n\nvec2 horner (in int n, in vec2 cs[N+1], in vec2 x) {\n    vec2 p;\n    for (int i = N - 1; i >= 0; i--)\n        if (i >= n)\n            p = cs[i];\n        else if (i < n)\n            p = cs[i] + cm(p, x);\n    return p;\n}\n\nvoid weierstrass (in vec2 cs[N+1], out vec2 roots2[N]) {\n\t/* polynomial must be monic! */\n    vec2 csn = cs[sheets];\n    if (csn != vec2 (1.0, 0.0))\n        for (int i = 0; i <= sheets; i++)\n            cs[i] = cd (cs[i], csn);\n\n    float maxabs = length (cs[0]);\n    for (int i = 1; i < N; i++)\n        if (i < sheets)\n            maxabs = max (maxabs, length (cs[i]));\n    float upperBound = 1.0 + maxabs; /// length (cs[n]);\n    float phi = 2.0 * acos (-1.0) / float (sheets + 1);\n    float d = upperBound / float (sheets);\n    d = clamp (d, 1.0, 10.0);\n\tfor (int i = 0; i < sheets; i++)\n        roots2[i] = float (i) * d * vec2 (cos (float (i) * phi), sin (float (i) * phi));\n\n\tconst int maxiter = 50;\n\tbool changing;\n\tfor (int iter = 0; iter < maxiter; iter++)\n\t{\n\t\tchanging = false;\n\t\tfor (int i = 0; i < sheets; i++)\n        {\n            vec2 result = vec2 (1.0, 0.0);\n            for (int j = 0; j < sheets; j++)\n                if (j != i)\n                    result = cm (result, roots2[i] - roots2[j]);\n            vec2 update = cd (horner (sheets, cs, roots2[i]), result);\n            ///* safe-guard against large update */\n            //if (sheets > 1 && length (update) > 10)\n            //\tupdate /= length (update);\n            if (length (update) > 1e-2)\n                changing = true;\n            roots2[i] -= update;\n        }\n        if (!changing)\n            break;\n\t}\n}\n\nvoid quadratic_roots (in vec2 cs[N+1], out vec2 qroots[2]) {\n    if (cs[0] == vec2 (0.0, 0.0)) {\n        qroots[0] = vec2 (0.0, 0.0);\n        qroots[1] = -cd (cs[1], cs[2]);\n    }\n    else\n    {\n        vec2 r = csqrt (cm (cs[1], cs[1]) - 4.0 * cm (cs[2], cs[0]));\n        if (cs[1].x >= 0.0)\n            r = -r;\n        qroots[0] = cd (r - cs[1], 2.0 * cs[2]);\n        qroots[1] = cd (2.0 * cs[0], r - cs[1]);\n    }\n}\n\nvoid roots (in int n, in vec2 cs[N+1], out vec2 roots[N])\n{\n    if (n == 1) {\n        roots[0] = -cd (cs[0], cs[1]);\n        return;\n    }\n    if (n == 2) {\n        vec2 qroots[2];\n        quadratic_roots (cs, qroots);\n        roots[0] = qroots[0];\n        roots[1] = qroots[1];\n        return;\n    }\n    weierstrass (cs, roots);\n    /* selection sort by real part */\n    /*\n    for(int i = 0; i < n - 1; i++)\n    {\n        int jmin = i;\n        for (int j = i + 1; j < n; j++)\n            if (roots[j].x < roots[jmin].x)\n                jmin = j;\n        vec2 z = roots[i];\n        roots[i] = roots[jmin];\n        roots[jmin] = z;\n    }\n    */\n}\n\nvoid f (in vec2 x, out vec2 cs[N+1]);\nvec2 fx (in vec2 x, in vec2 y);\nvec2 fy (in vec2 x, in vec2 y);\nfloat rho (in vec2 x);\nfloat M (in vec2 x, in float rho);\n\nfloat epsilon (in vec2 ys[N]) {\n    float d = distance (ys[0], ys[1]);\n    if (sheets < 2)\n        return 1.0 / 0.0;\n    for (int j = 0; j < sheets; j++) {\n        for (int k = 0; k < sheets; k++) {\n            if (k > j)\n                d = min (d, distance (ys[j], ys[k]));\n        }\n    }\n    return d / 2.0;\n}\n\nfloat Y (in vec2 x, in vec2 ys[N]) {\n    float y = length (cd (fx (x, ys[0]), fy (x, ys[0])));\n    for (int j = 0; j < sheets; j++)\n        y = max (y, length (cd (fx (x, ys[j]), fy (x, ys[j]))));\n    return y;\n}\n\nfloat Delta (in vec2 x, in vec2 ys[N]) {\n    float eps = epsilon (ys);\n    float r = rho (x);\n    float m = M (x, r);\n    float y = Y (x, ys);\n    return r * (sqrt (pow (r * y - eps, 2.0) + 4.0 * eps * m) -\n        (r * y + eps)) / (2.0 * (m - r * y));\n}\n",
"DomainColouring.frag":"uniform int sheet;\nvarying vec2 vPosition;\nvec3 hue_to_rgb (in float hue)\n{\n    hue = mod (degrees (hue), 360.0) / 60.0;\n    int h = int (floor (hue));\n    float f = fract (hue);\n    if (h == 0)\n        return vec3 (1.0, f, 0.0);\n    else if (h == 1)\n        return vec3 (1.0 - f, 1.0, 0.0);\n    else if (h == 2)\n        return vec3 (0.0, 1.0, f);\n    else if (h == 3)\n        return vec3 (0.0, 1.0 - f, 1.0);\n    else if (h == 4)\n        return vec3 (f, 0.0, 1.0);\n    else if (h == 5)\n        return vec3 (1.0, 0.0, 1.0 - f);\n}\nfloat sawfct (float x, float dx, float a, float b)\n{\n    return a + (b - a) * fract (x / dx);\n}\nvoid main (void)\n{\n    vec2 cs[N+1];\n    vec2 ys[N];\n    vec2 value;\n    f (vPosition, cs);\n    roots (sheets, cs, ys);\n    int smaller;\n    for (int i = 0; i < sheets; i++)\n    {\n        smaller = 0;\n        for (int j = 0; j < sheets; j++)\n            if (ys[j].x < ys[i].x)\n                smaller++;\n        if (smaller == sheet - 1)\n            value = ys[i];\n    }\n        \n    float PI = acos (-1.0);\n    float angle = atan (value.y, value.x);\n    float blackp = sawfct (angle, PI / 12.0, 0.7, 1.0);\n    float blackm = sawfct (log (length (value)), PI / 12.0, 0.7, 1.0);\n    float black = blackp * blackm;\n    gl_FragColor = vec4 (black * hue_to_rgb(angle), 1.0);\n}\n",
"DomainColouring.vert":"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute vec2 position;\nvarying vec2 vPosition;\nvoid main () {\n    gl_Position = vec4 (position, 0.0, 1.0);\n    vPosition = 5.0 * position;\n}\n","Dummy.frag":"#version 300 es\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nout vec4 fColor;\nvoid main(void) {\n    fColor = vec4(1.0);\n}\n","Export.frag":"#version 300 es\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nin vec2 vValue;\nout vec4 fColor;\nvec3 hue_to_rgb (in float hue)\n{\n    hue = mod (degrees (hue), 360.0) / 60.0;\n    int h = int (floor (hue));\n    float f = fract (hue);\n    if (h == 0)\n        return vec3 (1.0, f, 0.0);\n    else if (h == 1)\n        return vec3 (1.0 - f, 1.0, 0.0);\n    else if (h == 2)\n        return vec3 (0.0, 1.0, f);\n    else if (h == 3)\n        return vec3 (0.0, 1.0 - f, 1.0);\n    else if (h == 4)\n        return vec3 (f, 0.0, 1.0);\n    else if (h == 5)\n        return vec3 (1.0, 0.0, 1.0 - f);\n}\nfloat sawfct (float x, float dx, float a, float b)\n{\n    return a + (b - a) * fract (x / dx);\n}\nvoid main (void)\n{\n    float PI = acos (-1.0);\n    float angle = atan (vValue.y, vValue.x);\n    float blackp = sawfct (angle / (2.0 * PI), 0.05, 0.7, 1.0);\n    float blackm = sawfct (log (length (vValue)), 0.1 * PI, 0.7, 1.0);\n    float black = blackp * blackm;\n    fColor = vec4 (black * hue_to_rgb(angle), 1.0);\n}\n",
"Export.vert":"#version 300 es\nuniform float maxValue;\nuniform float minValue;\nin vec2 vPosition;\nout vec2 vValue;\n\nvoid main()\n{\n  gl_Position = vec4(vPosition, 0.0, 1.0);\n  vValue = 0.5 * (maxValue - minValue) * (vPosition + vec2 (1.0, 1.0))\n    + vec2 (minValue, minValue);\n}\n","FXAA.frag":"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform sampler2D u_tex;\nuniform float width;\nuniform float height;\n\n#define FXAA_REDUCE_MIN (1.0/ 128.0)\n#define FXAA_REDUCE_MUL (1.0 / 8.0)\n#define FXAA_SPAN_MAX 8.0\n// from https://github.com/mitsuhiko/webgl-meincraft/blob/master/assets/shaders/fxaa.glsl\nvec4 applyFXAA(in vec2 fragCoord, in sampler2D tex)\n{\n    vec4 color;\n    vec2 inverseVP = vec2(1.0 / width, 1.0 / height);\n    vec3 rgbNW = texture2D(tex, (fragCoord + vec2(-1.0, -1.0)) * inverseVP).xyz;\n    vec3 rgbNE = texture2D(tex, (fragCoord + vec2(1.0, -1.0)) * inverseVP).xyz;\n    vec3 rgbSW = texture2D(tex, (fragCoord + vec2(-1.0, 1.0)) * inverseVP).xyz;\n    vec3 rgbSE = texture2D(tex, (fragCoord + vec2(1.0, 1.0)) * inverseVP).xyz;\n    vec3 rgbM = texture2D(tex, fragCoord * inverseVP).xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM = dot(rgbM, luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y = ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n    (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n    max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n    dir * rcpDirMin)) * inverseVP;\n    vec3 rgbA = 0.5 * (\n    texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n    texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n    texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n    texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, 1.0);\n    else\n        color = vec4(rgbB, 1.0);\n    return color;\n}\n\nvoid main (void)\n{\n    gl_FragColor = applyFXAA(gl_FragCoord.xy, u_tex);\n}\n",
"FXAA.vert":"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nattribute vec2 vPosition;\nvoid main()\n{\n  gl_Position = vec4(vPosition, 0.0, 1.0);\n}\n","Initial.vert":"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nin vec2 pos;\nout vec2 position;\nout float delta;\nout float subdivisionFlag;\nout vec2 values[N];\nvoid main (void) {\n    position = clamp (pos, -5.0, 5.0);\n    vec2 cs[N+1];\n    f (position, cs);\n    roots (sheets, cs, values);\n    delta = Delta (position, values);\n    subdivisionFlag = 1.0;\n}\n",
"Subdivision.vert":"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nin vec3 barycentric;\nin float indexOffsetIn;\nuniform sampler2D samplers[1 + N/2];\nout vec2 position;\nout float delta;\nout float subdivisionFlag;\nout vec2 values[N];\n\n#define W 2048.0\n#define H 2048.0\nvec2 uvPosition (in float i) {\n    return vec2 (mod (i, W) / W + 0.5 / W, floor (i / W) / H + 0.5 / H);\n}\n\nvoid main (void) {\n    vec2 texCoord[3];\n    texCoord[0] = uvPosition (indexOffsetIn);\n    texCoord[1] = uvPosition (indexOffsetIn + 1.0);\n    texCoord[2] = uvPosition (indexOffsetIn + 2.0);\n    vec4 tmp;\n\n    if (barycentric == vec3 (1.0, 0.0, 0.0)) {\n        tmp = texture (samplers[0], texCoord[0]);\n        position = tmp.xy;\n        delta = tmp.z;\n        subdivisionFlag = tmp.w;\n        for (int j = 1; j < 1 + N/2; j++) {\n            tmp = texture (samplers[j], texCoord[0]);\n            values[2 * j - 2] = tmp.xy;\n            values[2 * j - 1] = tmp.zw;\n        }\n    } else if (barycentric == vec3 (0.0, 1.0, 0.0)) {\n        tmp = texture (samplers[0], texCoord[1]);\n        position = tmp.xy;\n        delta = tmp.z;\n        subdivisionFlag = tmp.w;\n        for (int j = 1; j < 1 + N/2; j++) {\n            tmp = texture (samplers[j], texCoord[1]);\n            values[2 * j - 2] = tmp.xy;\n            values[2 * j - 1] = tmp.zw;\n        }\n    } else if (barycentric == vec3 (0.0, 0.0, 1.0)) {\n        tmp = texture (samplers[0], texCoord[2]);\n        position = tmp.xy;\n        delta = tmp.z;\n        subdivisionFlag = tmp.w;\n        for (int j = 1; j < 1 + N/2; j++) {\n            tmp = texture (samplers[j], texCoord[2]);\n            values[2 * j - 2] = tmp.xy;\n            values[2 * j - 1] = tmp.zw;\n        }\n    } else {\n        position = barycentric.x * texture (samplers[0], texCoord[0]).xy\n                 + barycentric.y * texture (samplers[0], texCoord[1]).xy\n                 + barycentric.z * texture (samplers[0], texCoord[2]).xy;\n        vec2 cs[N+1];\n        f (position, cs);\n        roots (sheets, cs, values);\n        delta = Delta (position, values);\n        subdivisionFlag = 1.0;\n    }\n}\n",
"SubdivisionPre.vert":"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nin float index;\nuniform sampler2D samplers[1 + N/2];\nout vec2 position;\nout float delta;\nout float subdivisionFlag;\nout vec2 values[N];\n\n#define W 2048.0\n#define H 2048.0\nvec2 uvPosition (in float i) {\n    return vec2 (mod (i, W) / W + 0.5 / W, floor (i / W) / H + 0.5 / H);\n}\n\nvoid main (void) {\n    float which = mod (index, 3.0);\n    vec2 texCoordWhich = uvPosition (index);\n    vec2 texCoord[3];\n    texCoord[0] = uvPosition (index - which);\n    texCoord[1] = uvPosition (index - which + 1.0);\n    texCoord[2] = uvPosition (index - which + 2.0);\n    vec4 s = texture (samplers[0], texCoordWhich);\n    position = s.xy;\n    delta = s.z;\n    subdivisionFlag = 0.0;\n    vec3 positionDelta[3];\n    positionDelta[0] = texture (samplers[0], texCoord[0]).xyz;\n    positionDelta[1] = texture (samplers[0], texCoord[1]).xyz;\n    positionDelta[2] = texture (samplers[0], texCoord[2]).xyz;\n    if (distance (positionDelta[0].xy, positionDelta[1].xy) >= min (positionDelta[0].z, positionDelta[1].z))\n        subdivisionFlag += 4.0;\n    if (distance (positionDelta[1].xy, positionDelta[2].xy) >= min (positionDelta[1].z, positionDelta[2].z))\n        subdivisionFlag += 2.0;\n    if (distance (positionDelta[2].xy, positionDelta[0].xy) >= min (positionDelta[2].z, positionDelta[0].z))\n        subdivisionFlag += 1.0;\n    if (subdivisionFlag == 3.0 && distance (positionDelta[0].xy, 0.5 * (positionDelta[1].xy + positionDelta[2].xy)) < distance (positionDelta[1].xy, 0.5 * (positionDelta[0].xy + positionDelta[2].xy)))\n        subdivisionFlag = 8.0;\n    if (subdivisionFlag == 5.0 && distance (positionDelta[1].xy, 0.5 * (positionDelta[0].xy + positionDelta[2].xy)) < distance (positionDelta[2].xy, 0.5 * (positionDelta[0].xy + positionDelta[1].xy)))\n        subdivisionFlag = 9.0;\n    if (subdivisionFlag == 6.0 && distance (positionDelta[2].xy, 0.5 * (positionDelta[0].xy + positionDelta[1].xy)) < distance (positionDelta[0].xy, 0.5 * (positionDelta[1].xy + positionDelta[2].xy)))\n        subdivisionFlag = 10.0;\n    for (int i = 1; i < N/2; i++) {\n        s = texture (samplers[i], texCoordWhich);\n        values[2*i-2] = s.xy;\n        values[2*i-1] = s.zw;\n    }\n}\n",
"Surface.frag":"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform bool clipping;\nin vec4 vPos;\nin vec2 v_value;\nout vec4 fColor;\nvec3 hue_to_rgb (in float hue)\n{\n    hue = mod (degrees (hue), 360.0) / 60.0;\n    int h = int (floor (hue));\n    float f = fract (hue);\n    if (h == 0)\n        return vec3 (1.0, f, 0.0);\n    else if (h == 1)\n        return vec3 (1.0 - f, 1.0, 0.0);\n    else if (h == 2)\n        return vec3 (0.0, 1.0, f);\n    else if (h == 3)\n        return vec3 (0.0, 1.0 - f, 1.0);\n    else if (h == 4)\n        return vec3 (f, 0.0, 1.0);\n    else if (h == 5)\n        return vec3 (1.0, 0.0, 1.0 - f);\n}\nfloat sawfct (float x, float dx, float a, float b)\n{\n    return a + (b - a) * fract (x / dx);\n}\nvoid main (void)\n{\n    if (clipping && vPos.y < 0.0)\n        discard;\n    float PI = acos (-1.0);\n    float angle = atan (v_value.y, v_value.x);\n    float blackp = sawfct (angle, PI / 12.0, 0.7, 1.0);\n    float blackm = sawfct (log (length (v_value)), PI / 12.0, 0.7, 1.0);\n    float black = blackp * blackm;\n    fColor = vec4 (black * hue_to_rgb (angle), gl_FragCoord.z);\n}\n",
"Surface.vert":"#version 300 es\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nuniform mat4 m;\nuniform mat4 v;\nuniform mat4 p;\nin vec4 posValue;\nout vec4 vPos;\nout vec2 v_value;\nvoid main (void)\n{\n    vPos = vec4 (posValue.xyz, 1.0);\n    v_value = posValue.zw;\n    gl_Position = p * v * m * vPos;\n}\n"};function m(){}
m.a=function(a){if(null===a)return null;var c=a.type,b=a.value;if("infix"===c){c=m.a(a.first);a=m.a(a.second);if("+"===b)return ba(c,a);if("-"===b)return ba(c,t(a));if("*"===b)return ca(c,a);if("^"===b){if(da(a)&&(b=ea(a),0<=b.a&&0===b.b))return fa(c,b.a);console.error("Illegal exponent")}else console.error("Infix operator '"+b+"' not implemented")}else if("prefix"===c){c=m.a(a.first);if("+"===b)return c;if("-"===b)return t(c);console.error("Prefix operator '"+b+"' not implemented")}else{if("number"===c)return new u([new w(x(parseFloat(b)),
new z({}))]);if("variable"===c)return c={},c[b]=1,new u([new w(ha,new z(c))]);if("imaginary"===c)return new u([new w(new A(0,1),new z({}))])}return null};m.f=function(a){return 2===C(a).length};
m.b=function(a){function c(a,b){function c(a,b){return{type:"infix",value:b[0].value,first:a,second:b[1]}}return b===[]?a:b.reduce(c,a)}function b(a){a=D(ia(ja(l,d),d),la(D(l,d)))(a);return null===a?null:c(a[0],a[1])}function d(a){a=D(e,la(D(q,e)))(a);return null===a?null:c(a[0],a[1])}function e(a){var c=ia(ma(b),g,h,n)(a);if(null===c)return null;a=f(a);return null===a?c:{type:"infix",value:"^",first:c,second:a}}function f(a){var b=D(p,g)(a);if(null===b)return null;a=f(a);return null===a?b[1]:{type:"infix",
value:"^",first:b[1],second:a}}a=na(a);var g=oa("number"),h=oa("imaginary"),n=oa("variable"),l=ia(E("+"),E("-")),q=E("*"),p=E("^");return function(a){a=D(b,pa)(a);return null===a?null:a[0]}(a)};m.g=function(a){return qa(a)};var F=5/12*Math.PI,G=Math.PI/6;function H(a,c,b,d,e){c=void 0===c?F:c;b=void 0===b?G:b;this.f=a;c=I(c,b);b=new ra;b.A=void 0===d?!1:d;b.j=b.P=b.o=c;this.a=b;this.b=new sa(a,void 0===e?"webgl2":e);ta(this)}function ua(a,c,b,d,e,f){d=void 0===d?F:d;e=void 0===e?G:e;a=new H(a,d,e,void 0===f?!1:f);d=a.b;d.s=new va(d,c,b);if(2!==C(c).length||2>d.s.H)return null;J(a);return a}k=H.prototype;k.pa=function(a){var c=this.b;return c.s.ba(c,void 0===a?!1:a)};
k.qa=function(a){var c=this.b;c.s.ca(c,void 0===a?"surface.bin":a)};k.ra=function(a,c){var b=this.b;b.s.da(b,void 0===a?"sheet":a,void 0===c?!0:c)};k.Da=function(a,c){a=void 0===a?"surface.png":a;c=void 0===c?!1:c;var b=this,d=this.b;wa(d,function(){J(b)},c);c=xa(d,c?d.w:d.v);K(a,ya(c))};k.sa=function(a,c){var b=this.b;b.s.ea(b,void 0===a?"surface":a,void 0===c?!0:c)};
function ta(a){var c=a.f,b=a.a;a.g=function(c){c.preventDefault();b.m||(za(b,[c.clientX,c.clientY]),J(a))};a.L=function(a){a.preventDefault();Aa(b,a.clientX,a.clientY)};a.M=function(a){a.preventDefault();b.O=[0,0];b.B=!1};a.na=function(c){c.preventDefault();c=c.touches[0];za(b,[c.clientX,c.clientY]);J(a)};a.ma=function(a){a.preventDefault();a=a.touches[0];Aa(b,a.clientX,a.clientY)};a.N=function(a){a.preventDefault();b.O=[0,0];b.B=!1};a.oa=function(c){c.preventDefault();b.C=0<c.deltaY?Math.min(4,b.C+
.1):Math.max(.5,b.C-.1);J(a)};c.addEventListener("mousedown",a.g);c.addEventListener("mousemove",a.L);c.addEventListener("mouseup",a.M);c.addEventListener("touchstart",a.na);c.addEventListener("touchmove",a.ma);c.addEventListener("touchend",a.N);c.addEventListener("wheel",a.oa)}function J(a){var c=a.a;Ca(a.b,c);if(c.m||c.B||1E-6<Da(c.j,c.o).abs())Ea(c),requestAnimationFrame(function(){J(a)})}k.Ea=function(){this.u(Math.PI/2,Math.PI)};k.Fa=function(){this.u(Math.PI,0)};k.Ga=function(){this.u(F,G)};
k.Ha=function(){this.u(Math.PI/2,0)};k.u=function(a,c){this.a.m=!1;this.a.o=this.a.P=this.a.j;this.a.o=I(a,c);J(this)};k.Ia=function(){this.u(Math.PI/2,-Math.PI/2)};k.Ja=function(){this.u(Math.PI/2,Math.PI/2)};k.Ka=function(){this.u(0,0)};k.ta=function(a){this.b.J=a;J(this)};k.ua=function(a){this.a.m=a;J(this)};k.La=function(a,c,b,d){this.b.c.clearColor(a,c,b,d);J(this)};k.va=function(a){this.b.I=a;J(this)};k.Ma=function(a,c){a=I(a,c);this.a.m=!1;this.a.B=!1;this.a.j=this.a.o=a;J(this)};
k.wa=function(a){this.a.A=a;J(this)};k.xa=function(a){this.b.S=a;J(this)};k.Na=function(a){this.a.C=a||1;J(this)};k.ya=function(){var a=this.b;a.J=!a.J;J(this)};k.za=function(){var a=this.a;a.m=!a.m;J(this)};k.Aa=function(){var a=this.b;a.I=!a.I;J(this)};k.Ba=function(){var a=this.a;a.A=!a.A;J(this)};k.Ca=function(){var a=this.b;a.S=!a.S;J(this)};
k.Oa=function(){var a=this.f;a.removeEventListener("mousedown",this.g);a.removeEventListener("mousemove",this.L);a.removeEventListener("mouseup",this.M);a.removeEventListener("touchstart",this.na);a.removeEventListener("touchmove",this.ma);a.removeEventListener("touchend",this.N);a.removeEventListener("wheel",this.oa)};window.ComplexCurves=H;H.fromEquation=function(a,c,b,d,e,f){d=void 0===d?F:d;e=void 0===e?G:e;f=void 0===f?!1:f;c=m.a(m.b(c));return ua(a,c,b,d,e,f)};H.fromFile=function(a,c,b,d,e,f,g){d=void 0===d?F:d;e=void 0===e?G:e;f=void 0===f?!1:f;g=void 0===g?function(){}:g;b=m.a(m.b(void 0===b?"":b));var h=new H(a,d,e,f,"webgl");a=h.b;a.s=new Fa(a,c,b,function(){J(h);g()});return h};H.fromPolynomial=ua;H.prototype.domainColouring=H.prototype.pa;H.prototype.exportBinary=H.prototype.qa;
H.prototype.exportDomainColouring=H.prototype.ra;H.prototype.exportScreenshot=H.prototype.Da;H.prototype.exportSurface=H.prototype.sa;H.prototype.rotateBack=H.prototype.Ea;H.prototype.rotateBottom=H.prototype.Fa;H.prototype.rotateDefault=H.prototype.Ga;H.prototype.rotateFront=H.prototype.Ha;H.prototype.rotateLatLong=H.prototype.u;H.prototype.rotateLeft=H.prototype.Ia;H.prototype.rotateRight=H.prototype.Ja;H.prototype.rotateTop=H.prototype.Ka;H.prototype.setAntialiasing=H.prototype.ta;
H.prototype.setAutorotate=H.prototype.ua;H.prototype.setBackground=H.prototype.La;H.prototype.setClipping=H.prototype.va;H.prototype.setLatLong=H.prototype.Ma;H.prototype.setOrtho=H.prototype.wa;H.prototype.setTransparency=H.prototype.xa;H.prototype.setZoom=H.prototype.Na;H.prototype.toggleAntialiasing=H.prototype.ya;H.prototype.toggleAutorotate=H.prototype.za;H.prototype.toggleClipping=H.prototype.Aa;H.prototype.toggleOrtho=H.prototype.Ba;H.prototype.toggleTransparency=H.prototype.Ca;
H.prototype.unregisterEventHandlers=H.prototype.Oa;window.PolynomialParser=m;m.eval=m.a;m.isBivariate=m.f;m.parse=m.b;m.sheets=m.g;function Ga(a,c){var b=[L("Assembly.vert"),L("Dummy.frag")];b[0]=M(c,b[0]);this.a=N(a,b,["posValue"])}Ga.prototype.a=null;
Ga.prototype.l=function(a,c,b){var d=c.G;b.useProgram(this.a);var e=c.h;b.uniform1f(b.getUniformLocation(this.a,"numIndices"),e);Ha(c,a);b.vertexAttribPointer(0,1,b.FLOAT,!1,0,0);var f=c.H;a=4*e*f;for(var g=[],h=0,n=d.length;h<n;h++)b.activeTexture(b.TEXTURE0+h),b.bindTexture(b.TEXTURE_2D,d[h]),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,
b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),g[h]=h;b.uniform1iv(b.getUniformLocation(this.a,"samplers"),g);b.disable(b.DEPTH_TEST);var l=b.getUniformLocation(this.a,"sheet");Ia(b,c,a,function(){for(var a=0;a<f;a++)b.uniform1f(l,a),b.drawArrays(b.TRIANGLES,0,e)});c.h*=f;b.enable(b.DEPTH_TEST)};function Fa(a,c,b,d){d=void 0===d?function(){}:d;var e=this;e.D=void 0===b?null:b;Ja(e,c,function(){var b=e.W,c=a.c;e.ga=b.byteLength/16;c.enableVertexAttribArray(0);e.X=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,e.X);c.bufferData(c.ARRAY_BUFFER,new Float32Array(b),c.STATIC_DRAW);e.T=N(a,Ka("CachedSurface"));d()})}k=Fa.prototype;k.ba=function(a,c){return this.D?La(this.D,a,void 0===c?!1:c):[]};k.ca=function(a,c){K(void 0===c?"surface.bin":c,this.fa)};
k.da=function(a,c,b){this.D&&Ma(this.D,a,void 0===c?"sheet":c,void 0===b?!0:b)};k.ea=function(a,c,b){c=void 0===c?"surface":c;b=void 0===b?!0:b;Na(a,new Float32Array(this.W),c,b)};k.fa="";function Ja(a,c,b){a.fa=c;var d=new XMLHttpRequest;d.open("GET",c,!0);d.responseType="arraybuffer";d.onload=function(){a.W=d.response;b()};d.send()}k.D=null;k.W=null;k.X=null;k.T=null;
k.l=function(a,c,b){this.T&&(c.useProgram(this.T),Oa(a),Pa(a,"m",Qa(b.j)),Ra(a,b),Sa(a,b),Ta(a),c.bindBuffer(c.ARRAY_BUFFER,this.X),c.vertexAttribPointer(0,4,c.FLOAT,!1,0,0),c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT),c.drawArrays(c.TRIANGLES,0,this.ga),Ta(a,!1))};k.ga=0;function A(a,c){this.a=a;this.b=c}A.prototype.abs=function(){return Math.sqrt(this.a*this.a+this.b*this.b)};function O(a,c){return new A(a.a+c.a,a.b+c.b)}A.prototype.add=function(a){return O(this,a)};function P(a,c){var b=c.a*c.a+c.b*c.b;return new A((a.a*c.a+a.b*c.b)/b,(a.b*c.a-a.a*c.b)/b)}A.prototype.b=0;var Ua=new A(Infinity,Infinity);function Q(a,c){return new A(a.a*c.a-a.b*c.b,a.a*c.b+a.b*c.a)}function Va(a){return new A(-a.a,-a.b)}var ha=new A(1,0);A.prototype.a=0;
function x(a){return new A(a,0)}function Wa(a){if(0===a.a&&0===a.b)return R();var c=a.abs();return new A(Math.sqrt(.5*(c+a.a)),(Math.sign(a.b)||1)*Math.sqrt(.5*(c-a.a)))}function S(a,c){return new A(a.a-c.a,a.b-c.b)}function R(){return new A(0,0)};function La(a,c,b){function d(a){e.useProgram(h);e.bindBuffer(e.ARRAY_BUFFER,c.F);e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0);n=e.getUniformLocation(h,"sheet");e.uniform1i(n,a);e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);e.drawArrays(e.TRIANGLES,0,3)}b=void 0===b?!1:b;var e=c.c,f=Ka("DomainColouring"),g=Xa(a);f[1]=[g,aa["Common.glsl"],f[1]].join("\n");var h=N(c,f),n;f=C(a);a=T(a,0===f.length?"y":f[f.length-1]);f=[];for(var l=1;l<=a;l++)wa(c,d.bind(null,l),b),g=xa(c,b?c.w:c.v),f[l-1]=ya(g);return f}
function K(a,c){var b=document.createElement("a");b.href=c;b.download=a;b.style.display="none";document.body.appendChild(b);b.click();document.body.removeChild(b)}function Ma(a,c,b,d){b=void 0===b?"sheet":b;a=La(a,c,void 0===d?!0:d);c=0;for(d=a.length;c<d;c++)K(b+(c+1)+".png",a[c])}
function Na(a,c,b,d){b=void 0===b?"surface":b;d=void 0===d?!0:d;var e,f=-Infinity,g=Infinity;var h=c.byteLength/c.BYTES_PER_ELEMENT/4;var n=[];for(e=0;e<4*h;e+=4){var l=c[e];var q=c[e+1];var p=c[e+2];var r=c[e+3];n.push([l,q,p]);g=Math.min(g,Math.min(p,r));f=Math.max(f,Math.max(p,r))}l=f-g;var v=[];for(e=2;e<4*h;e+=4)q=(c[e]-g)/l,p=(c[e+1]-g)/l,v.push([q,p]);c=[];for(e=1;e<=h;e+=3)l=e+1,q=e+2,c.push([e,l,q]);var B=n.map(function(a,b){var c=v[b];return n.findIndex(function(b,d){d=v[d];return a[0]===
b[0]&&a[1]===b[1]&&a[2]===b[2]&&c[0]===d[0]&&c[1]===d[1]})});var W=Array.from(new Set(B));n=W.map(function(a){return n[a]});v=W.map(function(a){return v[a]});c=c.map(function(a){return a.map(function(a){return W.findIndex(function(b){return b===B[a-1]})+1})});e=n.map(function(a){return"v "+a[0]+" "+a[1]+" "+a[2]});h=v.map(function(a){return"vt "+a[0]+" "+a[1]});c=c.map(function(a){var b=a[0],c=a[1];a=a[2];return"f "+b+"/"+b+" "+c+"/"+c+" "+a+"/"+a});l=["mtllib "+b+".mtl","usemtl surface","s 1"];l=
l.concat(e,h,c);l="data:text/plain,"+encodeURIComponent(l.join("\n"));K(b+".obj",l);var y=a.c,Ba=N(a,Ka("Export")),ka;wa(a,function(){y.useProgram(Ba);y.bindBuffer(y.ARRAY_BUFFER,a.F);y.vertexAttribPointer(0,2,y.FLOAT,!1,0,0);ka=y.getUniformLocation(Ba,"minValue");y.uniform1f(ka,g);ka=y.getUniformLocation(Ba,"maxValue");y.uniform1f(ka,f);y.clear(y.COLOR_BUFFER_BIT|y.DEPTH_BUFFER_BIT);y.drawArrays(y.TRIANGLES,0,3)},d);d=xa(a,d?a.w:a.v);K(b+".png",ya(d));d=["newmtl surface","map_Kd "+b+".png","illum 0"];
d="data:text/plain,"+encodeURIComponent(d.join("\n"));K(b+".mtl",d)}function ya(a){var c=Math.sqrt(a.length/4),b=document.createElement("canvas");b.width=c;b.height=c;var d=b.getContext("2d"),e=d.createImageData(b.width,b.height);e.data.set(a);d.putImageData(e,0,0);a=document.createElement("canvas");a.width=c;a.height=c;c=a.getContext("2d");c.translate(0,a.height-1);c.scale(1,-1);c.drawImage(b,0,0);return a.toDataURL()};function Ya(a){var c=[],b;if(da(a))return[U(ea(a))];if(1===C(a).length){a=Za(a);var d=0;for(b=a.length;d<b;d++)c[d]=U(a[d])}else if(2===C(a).length){d=C(a);var e=d[0];a=V(a,d[1]);d=0;for(b=a.length;d<b;d++)c[d]=X(e,Ya(a[d]))}return c}function U(a){return"vec2 ("+a.a.toPrecision(8)+", "+a.b.toPrecision(8)+")"}
function $a(a,c){a=Ya(a).reverse();for(var b=Y-a.length+1,d=U(R()),e=0;e<b;e++)a.push(d);c=["void f (in vec2 "+c+", out vec2 cs[N+1])","{"];for(b=0;b<=Y;b++)c.push("cs["+b+"] = "+a[b]+";");c.push("}");return c.join("\n")}function ab(a,c,b){a=V(bb(a,c),b);for(var d=[],e=0,f=a.length;e<f;e++)d[e]=X(c,Ya(a[e]));return["vec2 fx (in vec2 "+c+", in vec2 "+b+")","{","    return "+X(b,d)+";","}"].join("\n")}
function cb(a,c,b){a=V(bb(a,b),c);for(var d=[],e=0,f=a.length;e<f;e++)d[e]=X(b,Ya(a[e]));return["vec2 fy (in vec2 "+c+", in vec2 "+b+")","{","    return "+X(c,d)+";","}"].join("\n")}function X(a,c){for(var b=c[0],d=1,e=c.length;d<e;d++)b="vec2 (1.0000000, 0.0000000)"===b?a:"vec2 (-1.0000000, 0.0000000)"===b?"-"+a:"cm ("+a+","+b+")","vec2 (0.0000000, 0.0000000)"!==c[d]&&(b+="+"+c[d]);return b}
function db(a,c,b){var d,e,f=V(a,b);var g=0;for(d=f.length;g<d;g++){var h=f[g].i;var n=0;for(e=h.length;n<e;n++){var l=h[n];h[n]=new w(x(l.b.abs()),l.a)}f[g]=new u(h)}g=f[0];g=eb(g,c,T(g,c));a=eb(a,b,T(a,b));a=fb(Za(a));b=["float M (in vec2 "+c+", in float rho)","{","    vec2 r = vec2 (length ("+c+") + rho, 0.0);","    float a["+f.length+"];","    a[0] = length ("+U(ea(g))+");"];g=0;for(d=a.length;g<d;g++)b.push("    a[0] *= distance ("+c+", "+U(a[g])+") - rho;");g=1;for(d=f.length;g<d;g++)b.push("    a["+
g+"] = length ("+X("r",Ya(f[g]))+");");b=b.concat(["    float m = a[1] / a[0];","    for (int j = 2; j < "+f.length+"; j++) {","        m = max (m, pow (a[j] / a[0], 1.0 / float (j)));","    }","    return 2.0 * m;","}"]);return b.join("\n")}
function gb(a,c,b){var d=eb(a,b,T(a,b)),e=bb(a,b);b=hb(b,a,e);e=b.values;a=e.length;0===a&&console.error("matrix must be non-empty");for(var f=0;f<a;f++)e[f].length!==a&&console.error("matrix must be square");f=b;for(e=1;e<a;e++){f=f.values;for(var g=f[0][0].ha(),h=[],n=0,l=f.length;n<l;n++){h[n]=[];for(var q=0;q<l;q++)if(q<n)h[n][q]=g;else if(q===n){for(var p=g,r=q+1;r<l;r++)p=p.add(t(f[r][r]));h[n][q]=p}else h[n][q]=f[n][q]}f=(new ib(h)).values;g=b.values;f[0].length!==g.length&&console.error("matrix dimensions must match");
h=[];n=f.length;l=g[0].length;q=f[0][0].ha();for(p=0;p<n;p++)for(h[p]=[],r=0;r<l;r++){for(var v=q,B=0,W=f[0].length;B<W;B++)v=v.add(ca(f[p][B],g[B][r]));h[p][r]=v}f=new ib(h)}b=f.values[0][0];a=0===a%2?t(b):b;d=fb(Za(d));f=fb(Za(a));e=[];a=0;for(b=d.length;a<b;a++)isFinite(d[a].abs())&&e.push(d[a]);a=0;for(b=f.length;a<b;a++)isFinite(f[a].abs())&&e.push(f[a]);d=["float rho (in vec2 "+c+") {","    float d = 100.0;"];a=0;for(b=e.length;a<b;a++)d.push("    d = min (d, distance ("+c+", "+U(e[a])+"));");
d=d.concat(["    return 0.999 * d;","}"]);return d.join("\n")}var Y=8;
function Xa(a){var c=C(a),b=2>c.length?"x":c[0];c=0===c.length?"y":c[c.length-1];return[["#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif","const int N = "+Y+";","const int sheets = "+T(a,c)+";","\n/* complex multiplication */\nvec2 cm (in vec2 a, in vec2 b)\n{\n    return vec2 (a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x);\n}"].join("\n"),$a(a,b),ab(a,b,c),cb(a,b,c),gb(a,b,c),db(a,b,c)].join("\n\n")};function jb(a,c){var b=kb(),d=a.c;c.h=b.length/2;d.enableVertexAttribArray(0);this.a=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,this.a);d.bufferData(d.ARRAY_BUFFER,new Float32Array(b),d.STATIC_DRAW);b=[L("Initial.vert"),L("Dummy.frag")];b[0]=M(c,b[0]);this.b=N(a,b,["position","delta","subdivisionFlag","values"])}jb.prototype.a=null;jb.prototype.b=null;
jb.prototype.l=function(a,c,b){b.useProgram(this.b);a=(4+2*Y)*c.h;b.enableVertexAttribArray(0);b.bindBuffer(b.ARRAY_BUFFER,this.a);b.vertexAttribPointer(0,2,b.FLOAT,!1,0,0);Ia(b,c,a,function(){b.drawArrays(b.TRIANGLES,0,c.h)});lb(b,c);b.bindBuffer(b.ARRAY_BUFFER,null)};function ib(a){this.values=a}ib.prototype.values=null;function kb(){for(var a=[],c=-10;10>c;c++)for(var b=-10;10>b;b++)a=0===(c+b)%2?a.concat([c,b,c+1,b,c,b+1,c+1,b,c+1,b+1,c,b+1]):a.concat([c,b,c+1,b+1,c,b+1,c,b,c+1,b,c+1,b+1]);return a.map(function(a){return a/2})};function mb(a,c,b){return a+b*(c-a)};function z(a){this.value=a}function nb(a){var c={};a=a.value;for(var b in a)c[b]=a[b];return new z(c)};function D(a){var c=arguments;return function(a){for(var b,e=[],f=0,g=c.length;f<g;f++)if(b=(0,c[f])(a))e.push(b);else return Array.prototype.unshift.apply(a,e),null;return e}}function ma(a){var c=E("("),b=E(")");return function(d){return(d=D(c,a,b)(d))?d[1]:null}}function pa(a){return 0===a.length?!0:null}function oa(a){return function(c){return(c[0]||{}).type===a?c.shift():null}}function la(a){return function(c){for(var b=a(c),d=[];null!==b;)d.push(b),b=a(c);return d}}
function ia(a){var c=arguments;return function(a){for(var b,e=0,f=c.length;e<f;e++)if(b=(0,c[e])(a))return b;return null}}function ja(a,c){return function(b){b=D(a,c)(b);return null===b?null:{type:"prefix",value:b[0].value,first:b[1]}}}function E(a){return function(c){return(c[0]||{}).value===a?c.shift():null}};function u(a){0===a.length?this.i=[new w(R(),new z({}))]:this.i=ob(a)}function ba(a,c){return new u(ob(a.i.concat(c.i)))}k=u.prototype;k.add=function(a){return ba(this,a)};function eb(a,c,b){a=a.i;for(var d=[],e=0,f=a.length;e<f;e++){var g=a[e];if((g.a.value[c]||0)===b){var h=nb(g.a);delete h.value[c];d.push(new w(g.b,h))}}return new u(d)}function V(a,c){for(var b=T(a,c),d=[],e=0;e<=b;e++)d[e]=eb(a,c,b-e);return d}
function Za(a){var c=C(a),b=c.length;1<b&&console.error("Polynomial is not univariate");a=V(a,0<b?c[0]:"x");c=[];b=0;for(var d=a.length;b<d;b++)c[b]=ea(a[b]);return c}function ea(a){var c=R();a=a.i;for(var b=0,d=a.length;b<d;b++){var e=a[b],f=e.a.value;if(null===f||0===Object.keys(f).length)c=O(c,e.b)}return c}function T(a,c){var b=0;a=a.i;for(var d=0,e=a.length;d<e;d++)b=Math.max(b,a[d].a.value[c]||0);return b}
function bb(a,c){a=a.i;for(var b=[],d=0,e=a.length;d<e;d++){var f=a[d].a,g=f.value[c]||0;if(0<g){var h=Q(a[d].b,x(g));f=nb(f);f.value[c]=g-1;b.push(new w(h,f))}}return new u(b)}function da(a){return 0===C(a).length&&0!==a.i.length}
function pb(a,c,b){for(var d=a.length-1,e=[1,.3141,.5926,.5358,.9793,.2385,.6264,.3383,.2795,.0288],f,g,h,n,l=1;l<=b;l++){h=R();f=R();g=a[0];for(n=1;n<=d;n++)h=O(f,Q(h,c)),f=O(g,Q(f,c)),g=O(a[n],Q(g,c));if(1E-14>g.abs())break;f=P(f,g);n=Q(f,f);g=S(n,P(Q(x(2),h),g));h=Wa(Q(x(d-1),S(Q(x(d),g),n)));g=O(f,h);f=S(f,h);g.abs()<f.abs()&&(g=f);f=1E-14<g.abs()?P(x(d),g):Q(x(c.abs()+1),new A(Math.cos(l),Math.sin(l)));if(1E-14>f.abs())break;0===l%20&&l<b-19&&(f=Q(f,x(e[Math.floor(l/20)])));c=S(c,f)}return c}
function ca(a,c){a=a.i;c=c.i;for(var b=[],d=0,e=a.length;d<e;d++)for(var f=0,g=c.length;f<g;f++){var h=void 0,n=a[d],l=c[f],q={},p=n.a.value,r=l.a.value;for(h in p)q[h]=p[h]+(r[h]||0);for(h in r)q[h]=r[h]+(p[h]||0);b.push(new w(Q(n.b,l.b),new z(q)))}return new u(ob(b))}function t(a){a=a.i;for(var c=[],b=0,d=a.length;b<d;b++){var e=a[b];c.push(new w(Va(e.b),e.a))}return new u(c)}
function fa(a,c){var b=new u([new w(x(1),new z({}))]);for(Number.isInteger(c)||console.error("Non-integer power of Polynomial!");0<c;c--)b=ca(b,a);return b}k.pow=function(a){return fa(this,a)};function qb(a){var c=a[0],b=a[1];a=a[2];if(0===a.a&&0===a.b)return[R(),Va(P(b,c))];var d=Wa(S(Q(b,b),Q(x(4),Q(c,a))));0<=b.a&&(d=Va(d));return[P(S(d,b),Q(x(2),c)),P(Q(x(2),a),S(d,b))]}
function fb(a){var c=[],b=a,d=a.length-1;if(0>=d)return[];var e=a[0];if(0===e.a&&0===e.b)return c=fb(a.slice(1)),c.push(Ua),c;if(1===d)c[0]=Va(P(a[1],a[0]));else if(2===d)c=qb(a);else{for(e=0;e<d-2;e++){c[e]=pb(a,R(),200);c[e]=pb(b,c[e],1);for(var f=c[e],g=[a[0]],h=1,n=a.length-1;h<n;h++)g[h]=O(a[h],Q(g[h-1],f));a=g}b=qb(a);c[d-2]=b[0];c[d-1]=b[1]}return c}function qa(a){var c=C(a);return T(a,0===c.length?"y":c[c.length-1])}k.sub=function(a){return ba(this,t(a))};
function hb(a,c,b){function d(a){for(var b=[],c=0;c<a;c++)b[c]=rb();return b}function e(a,b){return d(b).concat(a).concat(d(f+g-a.length-b))}var f=T(c,a),g=T(b,a);c=V(c,a);a=V(b,a);b=[];for(var h=0;h<g;h++)b.push(e(c,h));for(c=0;c<f;c++)b.push(e(a,c));return new ib(b)}k.i=null;function C(a){a=a.i;for(var c=[],b={},d=0,e=a.length;d<e;d++){var f=a[d].a.value,g;for(g in f)b[g]||(c.push(g),b[g]=!0)}c.sort();return c}function rb(){return new u([])}k.ha=rb;function Z(a,c,b,d){this.g=a;this.a=c;this.b=b;this.f=d}Z.prototype.abs=function(){return Math.sqrt(this.g*this.g+this.a*this.a+this.b*this.b+this.f*this.f)};function I(a,c){a=-a/2;c=-c/2;return sb(new Z(Math.cos(a),Math.sin(a),0,0),new Z(Math.cos(c),0,0,Math.sin(c)))}function tb(a,c,b){return new Z(mb(a.g,c.g,b),mb(a.a,c.a,b),mb(a.b,c.b,b),mb(a.f,c.f,b))}
function sb(a,c){return new Z(a.g*c.g-a.a*c.a-a.b*c.b-a.f*c.f,a.g*c.a+a.a*c.g+a.b*c.f-a.f*c.b,a.g*c.b-a.a*c.f+a.b*c.g+a.f*c.a,a.g*c.f+a.a*c.b-a.b*c.a+a.f*c.g)}function ub(a){var c=a.abs();return new Z(a.g/c,a.a/c,a.b/c,a.f/c)}function Qa(a){var c=a.g,b=a.a,d=a.b;a=a.f;return[c*c+b*b-d*d-a*a,2*b*d+2*c*a,2*b*a-2*c*d,0,2*b*d-2*c*a,c*c-b*b+d*d-a*a,2*d*a+2*c*b,0,2*b*a+2*c*d,2*d*a-2*c*b,c*c-b*b-d*d+a*a,0,0,0,0,c*c+b*b+d*d+a*a]}function Da(a,c){return new Z(a.g-c.g,a.a-c.a,a.b-c.b,a.f-c.f)};function ra(){}k=ra.prototype;k.m=!1;k.O=[0,0];k.A=!1;k.B=!1;k.j=I(0,0);k.P=I(0,0);k.o=I(0,0);k.C=1;function za(a,c){a.m||(a.O=c,a.B=!0,a.P=a.o)}function Aa(a,c,b){if(a.B){var d=a.O;c-=d[0];b=d[1]-b;d=Math.sqrt(c*c+b*b);var e=a.P,f=d/Math.sqrt(1E4+d*d);a.o=ub(tb(e,sb(new Z(100/Math.sqrt(1E4+d*d),-f*b,f*c,0),e),.05))}}function Ea(a){if(a.m){var c=ub(new Z(.01,0,0,1));c=sb(c,c);a.j=a.o=sb(a.j,c)}else a.j=ub(tb(a.j,a.o,.1))};function sa(a,c){this.ka=c=void 0===c?"webgl2":c;if("webgl"===c){if(a=this.c=a.getContext("webgl",{preserveDrawingBuffer:!0}),!a)throw alert("WebGL not supported. Please try another browser or platform."),Error("WebGL not supported.");}else if(a=this.c=a.getContext("webgl2",{preserveDrawingBuffer:!0}),!a)throw alert("WebGL 2 not supported. Please try another browser or platform."),Error("WebGL 2 not supported.");a.enable(a.DEPTH_TEST);this.K=N(this,Ka("FXAA"));a=this.c;this.V=c=Math.min(a.getParameter(a.MAX_TEXTURE_SIZE),
8192);this.F=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.F);a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,-1,3,-1,-1,3]),a.STATIC_DRAW);a.vertexAttribPointer(0,2,a.FLOAT,!1,0,0);a.enableVertexAttribArray(0);this.Y=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,this.Y);this.Z=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,this.Z);a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,c,c);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,this.Z);
this.w=a.createTexture();a.bindTexture(a.TEXTURE_2D,this.w);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,c,c,0,a.RGBA,a.UNSIGNED_BYTE,null);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.w,0);this.$=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,this.$);this.aa=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,this.aa);a.renderbufferStorage(a.RENDERBUFFER,
a.DEPTH_COMPONENT16,2048,2048);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,this.aa);this.v=a.createTexture();a.bindTexture(a.TEXTURE_2D,this.v);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,2048,2048,0,a.RGBA,a.UNSIGNED_BYTE,null);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.v,0);a.bindTexture(a.TEXTURE_2D,null);a.bindRenderbuffer(a.RENDERBUFFER,
null);a.bindFramebuffer(a.FRAMEBUFFER,null);a.bindBuffer(a.ARRAY_BUFFER,null)}k=sa.prototype;k.V=8192;k.I=!1;k.ka="webgl2";k.J=!0;k.K=null;function L(a){return aa[a].trim()}function Ka(a){return[L(a+".vert"),L(a+".frag")]}k.c=null;
function N(a,c,b){var d=a.c,e=c[1],f=d.createShader(d.VERTEX_SHADER);d.shaderSource(f,c[0]);d.compileShader(f);d.getShaderParameter(f,d.COMPILE_STATUS)||console.log(d.getShaderInfoLog(f));var g=d.createProgram();d.attachShader(g,f);c[1]&&(c=d.createShader(d.FRAGMENT_SHADER),d.shaderSource(c,e),d.compileShader(c),d.getShaderParameter(c,d.COMPILE_STATUS)||console.log(d.getShaderInfoLog(c)),d.attachShader(g,c));b?(d.transformFeedbackVaryings(g,b,d.INTERLEAVED_ATTRIBS),d.enable(d.RASTERIZER_DISCARD)):
"webgl2"===a.ka&&d.disable(d.RASTERIZER_DISCARD);d.linkProgram(g);d.getProgramParameter(g,d.LINK_STATUS)||console.log(d.getProgramInfoLog(g));d.useProgram(g);return g}
function xa(a,c){var b=a.c,d=b.getParameter(b.FRAMEBUFFER_BINDING),e=b.createFramebuffer();b.bindFramebuffer(b.FRAMEBUFFER,e);b.bindTexture(b.TEXTURE_2D,c);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,c,0);if(b.checkFramebufferStatus(b.FRAMEBUFFER)!==
b.FRAMEBUFFER_COMPLETE)return b.bindTexture(b.TEXTURE_2D,null),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0),b.bindFramebuffer(b.FRAMEBUFFER,d),b.deleteFramebuffer(e),null;c===a.v?(a=new Uint8Array(16777216),b.readPixels(0,0,2048,2048,b.RGBA,b.UNSIGNED_BYTE,a)):c===a.w?(c=a.V,a=new Uint8Array(4*c*c),b.readPixels(0,0,c,c,b.RGBA,b.UNSIGNED_BYTE,a)):(a=new Float32Array(16777216),b.readPixels(0,0,2048,2048,b.RGBA,b.FLOAT,a));c=b.getError();b.bindTexture(b.TEXTURE_2D,null);
b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0);b.bindFramebuffer(b.FRAMEBUFFER,d);b.deleteFramebuffer(e);return c!==b.NO_ERROR?null:a}k.s=null;function Ca(a,c){var b=a.c;vb(a,function(){a.s.l(a,b,c)})}k.F=null;k.Y=null;k.Z=null;k.w=null;k.$=null;k.aa=null;k.v=null;k.S=!1;function Oa(a){var c=a.c;c.uniform1f(c.getUniformLocation(c.getParameter(c.CURRENT_PROGRAM),"clipping"),a.I?1:0)}
function Sa(a,c){var b=a.c,d=b.getParameter(b.VIEWPORT);b=d[2];d=d[3];if(c.A){var e=c.C;c=-7.5*e;var f=-7.5*e,g=7.5*e;e*=7.5;var h=Math.min(d/b,1);b=Math.min(b/d,1);b=[2*h/(g-f),0,0,0,0,2*b/(e-c),0,0,0,0,-.01,0,-h*(g+f)/(g-f),-b*(e+c)/(e-c),-0,1]}else c=1/Math.tan(45*c.C/2*Math.PI/180),b=[c/(0<d?b/d:b),0,0,0,0,c,0,0,0,0,101/-99,-1,0,0,200/-99,0];Pa(a,"p",b)}
function Ta(a,c){var b=a.c;a.S&&!1!==c?(b.blendFunc(b.SRC_ALPHA,b.ONE),b.enable(b.BLEND),b.disable(b.DEPTH_TEST)):(b.disable(b.BLEND),b.enable(b.DEPTH_TEST),b.depthFunc(b.LESS))}function Pa(a,c,b){a=a.c;a.uniformMatrix4fv(a.getUniformLocation(a.getParameter(a.CURRENT_PROGRAM),c),!1,b)}function Ra(a,c){Pa(a,"v",c.A?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-20,1])}
function vb(a,c){if(a.J&&null!==a.K){if(null!==a.K){wa(a,c);c=a.c;var b=a.K;c.useProgram(b);var d=c.getUniformLocation(b,"width");c.uniform1f(d,c.canvas.width);d=c.getUniformLocation(b,"height");c.uniform1f(d,c.canvas.height);c.bindBuffer(c.ARRAY_BUFFER,a.F);c.vertexAttribPointer(0,2,c.FLOAT,!1,0,0);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,a.v);c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT);c.drawArrays(c.TRIANGLES,0,3)}}else c()}
function wa(a,c,b){var d=a.c;(void 0===b?0:b)?(b=a.V,d.bindFramebuffer(d.FRAMEBUFFER,a.Y),d.viewport(0,0,b,b)):(d.bindFramebuffer(d.FRAMEBUFFER,a.$),d.viewport(0,0,2048,2048));c();d.viewport(0,0,d.canvas.width,d.canvas.height);d.bindFramebuffer(d.FRAMEBUFFER,null)};function wb(a,c){var b=[L("Subdivision.vert"),L("Dummy.frag")];b[0]=M(c,b[0]);this.a=N(a,b,["position","delta","subdivisionFlag","values"])}wb.prototype.a=null;
wb.prototype.l=function(a,c,b){var d,e=c.G,f=this.a;b.useProgram(f);var g=new Float32Array(c.h),h=xb(b,c),n=4+2*Y,l=n*c.h;a=3;for(d=0;a<l;a+=n,d++)g[d]=h[a];l=[1,0,0,0,1,0,0,0,1,1,0,0,0,1,0,.5,0,.5,0,1,0,0,0,1,.5,0,.5,1,0,0,0,1,0,0,.5,.5,0,.5,.5,0,0,1,1,0,0,1,0,0,0,1,0,.5,0,.5,0,.5,.5,0,0,1,.5,0,.5,.5,0,.5,0,1,0,0,.5,.5,1,0,0,.5,.5,0,0,0,1,0,0,1,.5,.5,0,0,1,0,1,0,0,.5,.5,0,.5,0,.5,.5,0,.5,.5,.5,0,0,0,1,0,1,0,0,0,1,.5,.5,0,1,0,0,.5,.5,0,0,.5,.5,0,0,1,1,0,0,0,.5,.5,0,.5,.5,.5,.5,0,0,1,0,1,0,0,.5,.5,
0,.5,0,.5,.5,.5,0,0,1,0,0,.5,.5,0,.5,.5,0,0,1,.5,0,.5,.5,.5,0,0,.5,.5,.5,0,.5,1,0,0,0,1,0,0,.5,.5,0,.5,.5,.5,0,.5,1,0,0,.5,0,.5,0,.5,.5,0,0,1,1,0,0,.5,.5,0,.5,0,.5,.5,0,.5,.5,.5,0,0,1,0,0,1,0,0,0,1,.5,0,.5,1,0,0,.5,.5,0,0,0,1,0,0,1,.5,.5,0,0,.5,.5,0,.5,.5,.5,.5,0,0,1,0];h=[0,3,9,15,24,30,39,48,60,69,78];var q=[3,6,6,9,6,9,9,12,9,9,9],p=[];a=0;for(d=e.length;a<d;a++)b.activeTexture(b.TEXTURE0+a),b.bindTexture(b.TEXTURE_2D,e[a]),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,
b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),p[a]=a;b.uniform1iv(b.getUniformLocation(f,"samplers"),p);f=[];p=[];var r=0;a=0;for(d=c.h/3;a<d;a++){var v=g[3*a],B=h[v];v=q[v];p.push(l.slice(3*B,3*(B+v)));for(B=0;B<v;B++)f.push(3*a);r+=v}p=Array.prototype.concat.apply([],p);l=n*r;g=b.createBuffer();b.enableVertexAttribArray(0);b.bindBuffer(b.ARRAY_BUFFER,g);b.bufferData(b.ARRAY_BUFFER,new Float32Array(p),
b.STATIC_DRAW);b.vertexAttribPointer(0,3,b.FLOAT,!1,0,0);n=b.createBuffer();b.enableVertexAttribArray(1);b.bindBuffer(b.ARRAY_BUFFER,n);b.bufferData(b.ARRAY_BUFFER,new Float32Array(f),b.STATIC_DRAW);b.vertexAttribPointer(1,1,b.FLOAT,!1,0,0);Ia(b,c,l,function(){b.drawArrays(b.TRIANGLES,0,r)});c.h=r;lb(b,c);a=0;for(d=e.length+1;a<d;a++)b.activeTexture(b.TEXTURE0+a),b.bindTexture(b.TEXTURE_2D,null);b.bindBuffer(b.ARRAY_BUFFER,null);b.deleteBuffer(n);b.deleteBuffer(g);b.disableVertexAttribArray(1)};function yb(a,c){var b=[L("SubdivisionPre.vert"),L("Dummy.frag")];b[0]=M(c,b[0]);this.a=N(a,b,["position","delta","subdivisionFlag","values"])}yb.prototype.a=null;
yb.prototype.l=function(a,c,b){var d=c.G,e=this.a;b.useProgram(e);Ha(c,a);b.vertexAttribPointer(0,1,b.FLOAT,!1,0,0);a=(4+2*Y)*c.h;for(var f=[],g=0,h=d.length;g<h;g++)b.activeTexture(b.TEXTURE0+g),b.bindTexture(b.TEXTURE_2D,d[g]),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),f[g]=g;b.uniform1iv(b.getUniformLocation(e,
"samplers"),f);Ia(b,c,a,function(){b.drawArrays(b.TRIANGLES,0,c.h)});lb(b,c);b.bindBuffer(b.ARRAY_BUFFER,null)};function va(a,c,b){this.a=c;this.f=b;this.H=qa(c);if(2===C(c).length)if(2>this.H)console.log("There must be at least two sheets!");else{b=a.c;this.ia=b.createBuffer();for(var d=a.c,e=[],f=0;5>f;f++)e[f]=d.createTexture(),d.bindTexture(d.TEXTURE_2D,e[f]),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),d.texImage2D(d.TEXTURE_2D,0,d.RGBA16F,2048,2048,0,d.RGBA,d.FLOAT,null);d.bindTexture(d.TEXTURE_2D,null);this.G=e;d=a.c;this.b=
d.createTransformFeedback();this.R=d.createBuffer();this.ja=aa["Common.glsl"].trim();this.la=Xa(c);this.L=new jb(a,this);this.L.l(a,this,b);this.N=new yb(a,this);this.M=new wb(a,this);for(c=0;c<this.f;c++)this.N.l(a,this,b),this.M.l(a,this,b);this.g=new Ga(a,this);this.g.l(a,this,b);c=Ka("Surface");c[1]=M(this,c[1]);this.U=N(a,c);a=b.canvas;b.viewport(0,0,a.width,a.height)}else console.log("Equation must be bivariate!")}k=va.prototype;k.ja="";k.la="";
k.ba=function(a,c){return La(this.a,a,void 0===c?!1:c)};k.ca=function(a,c){c=void 0===c?"surface.bin":c;var b=4;b=void 0===b?4+2*Y:b;a=xb(a.c,this,b);a=URL.createObjectURL(new Blob([a],{type:"application/octet-binary"}));K(c,a)};k.da=function(a,c,b){Ma(this.a,a,void 0===c?"sheet":c,void 0===b?!0:b)};k.ea=function(a,c,b){c=void 0===c?"surface":c;b=void 0===b?!0:b;var d=xb(a.c,this,4);Na(a,d,c,b)};
function Ha(a,c){c=c.c;for(var b=[],d=0;d<a.h;d++)b[d]=d;c.bindBuffer(c.ARRAY_BUFFER,a.ia);c.bufferData(c.ARRAY_BUFFER,new Float32Array(b),c.STATIC_DRAW)}k.ia=null;k.h=0;k.U=null;k.l=function(a,c,b){this.U&&(c.useProgram(this.U),Oa(a),Pa(a,"m",Qa(b.j)),Ra(a,b),Sa(a,b),Ta(a),c.bindBuffer(c.ARRAY_BUFFER,this.R),c.vertexAttribPointer(0,4,c.FLOAT,!1,0,0),c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT),c.drawArrays(c.TRIANGLES,0,this.h),Ta(a,!1))};k.H=0;k.G=[];k.R=null;
function M(a,c){return["#version 300 es",a.la,a.ja,c].join("\n")};function w(a,c){this.b=a;this.a=c}w.prototype.b=null;w.prototype.a=null;
function ob(a){function c(a,d){if(0===d.length)return a;if(1===d.length)return a.push(d[0]),a;var b=d.pop(),f=b.b;b=b.a;for(var g=[],h=0,n=d.length;h<n;h++){a:{var l=void 0;var q=b,p=d[h].a;for(l in q.value)if(!p.value.hasOwnProperty(l)||q.value[l]!==p.value[l]){l=!1;break a}for(l in p.value)if(!q.value.hasOwnProperty(l)||q.value[l]!==p.value[l]){l=!1;break a}l=!0}l?f=O(f,d[h].b):g.push(d[h])}a.push(new w(f,b));return c(a,g)}return c([],a)};function zb(){this.a=[["\\d*\\.\\d*","number"],["\\d+","number"],["i","imaginary"],["[a-hj-z]","variable"],["[\\+\\*\\^-]","operator"],["[\\(\\)]","parenthesis"]]}function na(a){for(var c=(new zb).a,b="(?:",d=0,e=c.length;d<e;d++)b+=(0<d?"|(":"(")+c[d][0]+")";b=new RegExp(b+")","g");for(d=[];null!==(e=b.exec(a));){var f=e[0];d.push({type:c[e.slice(1).indexOf(f)][1],value:f})}return d};function xb(a,c,b){b=void 0===b?4+2*Y:b;b=new Float32Array(b*c.h);a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,c.b);a.bindBufferBase(a.TRANSFORM_FEEDBACK_BUFFER,0,c.R);a.getBufferSubData(a.TRANSFORM_FEEDBACK_BUFFER,0,b);a.bindBufferBase(a.TRANSFORM_FEEDBACK_BUFFER,0,null);a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,null);return b}
function lb(a,c){var b=void 0===b?4+2*Y:b;for(var d=c.G,e=xb(a,c,b),f=new Float32Array(16777216),g=0;g<=Y/2;g++){a.bindTexture(a.TEXTURE_2D,d[g]);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);for(var h=0;h<c.h;h++)for(var n=0;4>n;n++)f[4*h+n]=e[b*h+4*g+n];a.texImage2D(a.TEXTURE_2D,0,a.RGBA16F,2048,
2048,0,a.RGBA,a.FLOAT,f)}}function Ia(a,c,b,d){a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,c.b);a.bindBufferBase(a.TRANSFORM_FEEDBACK_BUFFER,0,c.R);a.bufferData(a.TRANSFORM_FEEDBACK_BUFFER,b*Float32Array.BYTES_PER_ELEMENT,a.STATIC_COPY);a.beginTransformFeedback(a.TRIANGLES);d();a.endTransformFeedback();a.bindBufferBase(a.TRANSFORM_FEEDBACK_BUFFER,0,null);a.bindTransformFeedback(a.TRANSFORM_FEEDBACK,null)};
})();//# sourceMappingURL=ComplexCurves.js.map


//# sourceMappingURL=ComplexCurves.js.map
(function(){
'use strict';CindyJS.registerPlugin(1,"ComplexCurves",function(a){function b(b,a){var c,d;for(c in b)(d=a[c])?d(n(b[c])):console.log("Modifier "+c+" not supported")}function e(a,e){a=h(a[0],"CSCanvas");var c=g[a];if(!c)return console.log("Unknown instance '"+a+"'"),l;var d=1,f=[0,0,0];b(e,{alpha:function(a){d=k(a,d)},autorotate:function(a){c.setAutorotate(m(a))},background:function(a){f=q(a,f)},clip:function(a){c.setClipping(m(a))},ortho:function(a){c.setOrtho(m(a))},transparency:function(a){c.setTransparency(m(a))},
view:function(a){switch(h(a)){case "Back":c.rotateBack();break;case "Bottom":c.rotateBottom();break;case "Default":c.rotateDefault();break;case "Front":c.rotateFront();break;case "Left":c.rotateLeft();break;case "Right":c.rotateRight();break;case "Top":c.rotateTop()}},zoom:function(a){c.setZoom(r(a,1))}});c.setBackground(f[0],f[1],f[2],d);return l}var l=a.nada,n=a.evaluate;a=a.defineFunction;var g={};a("ComplexCurves",1,e);a("ComplexCurves",2,function(a,b){var c=h(a[0],"CSCanvas"),d=document.getElementById(c),
f=h(a[1],"y^2-x"),p=12;void 0!==b.depth&&(p=t(n(b.depth)));delete b.depth;g[c]&&g[c].f&&g[c].f();if(".bin"===f.substr(-4,4))var u=ComplexCurves.fromFile(d,f,"",void 0,void 0,void 0,function(){g[c]=u;e([a[0]],b)});else if(d=ComplexCurves.fromEquation(d,f,p))g[c]=d,e([a[0]],b);return l})});function v(a){var b;b=void 0===b?null:b;return"list"!==a.ctype?(console.log("argument is not a list"),b):a.value}function q(a,b){b=void 0===b?[.5,.5,.5]:b;if("number"===a.ctype){var e=k(a);if(!isNaN(e))return[e,e,e]}a=v(a);return null===a?b:3!=a.length?(console.log("Not an RGB color vector"),b):a.map(function(a){return k(a)})}
function r(a,b){b=void 0===b?Number.NaN:b;if("number"!==a.ctype)return console.log("argument is not a number"),b;a=a.value;b=a.real;0!==a.imag&&console.log("complex number is not real");return b}function t(a){var b=12,b=void 0===b?Number.NaN:b;if("number"!==a.ctype)return console.log("argument is not a number"),b;b=a.value;a=b.real;b=b.imag;0!==b&&console.log("complex number is not real");b=Math.round(a);b!==a&&console.log("number is not an integer");return b}
function k(a,b){b=void 0===b?Number.NaN:b;a=r(a,b);return 0>a?0:1<a?1:a}function h(a,b){b=void 0===b?null:b;if("string"===a.ctype)return a.value;console.log("argument is not a string");return b}function m(a){if("boolean"===a.ctype)return a.value;console.log("argument is not boolean");return!1};
})();

//# sourceMappingURL=ComplexCurves.js.map
